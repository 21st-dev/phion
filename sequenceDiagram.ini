sequenceDiagram
    participant U as üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
    participant B as üåê –ë—Ä–∞—É–∑–µ—Ä Next.js –ø–æ—Ä—Ç 3004
    participant V as üíª VSCode –∏–ª–∏ Cursor —Ä–µ–¥–∞–∫—Ç–æ—Ä
    participant W as üì° shipvibes-dev.js –∞–≥–µ–Ω—Ç —Å–ª–µ–∂–µ–Ω–∏—è –∑–∞ —Ñ–∞–π–ª–∞–º–∏
    participant WS as üîÑ WebSocket —Å–µ—Ä–≤–µ—Ä –ø–æ—Ä—Ç 8080
    participant DB as üóÉÔ∏è –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö Supabase PostgreSQL
    participant APP as ü§ñ Shipvibes Bot GitHub App ID 1390062
    participant GH as üêô GitHub API –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è shipvibes
    participant N as üî• –°–µ—Ä–≤–∏—Å –¥–µ–ø–ª–æ—è Netlify

    Note over U,N: üöÄ –ê–†–•–ò–¢–ï–ö–¢–£–†–ê SHIPVIBES - GITHUB APP + DEPLOY KEYS + –ë–ï–ó –õ–û–ì–ò–ù–ê –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø

    %% === 0. –ü–†–ï–î–í–ê–†–ò–¢–ï–õ–¨–ù–ê–Ø –ù–ê–°–¢–†–û–ô–ö–ê ===
    rect rgb(230, 230, 250)
        Note over APP,GH: 0Ô∏è‚É£ –ü–†–ï–î–í–ê–†–ò–¢–ï–õ–¨–ù–ê–Ø –ù–ê–°–¢–†–û–ô–ö–ê - –≤—ã–ø–æ–ª–Ω–µ–Ω–æ –¥–ª—è –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã
        
        Note over APP: GitHub App "Shipvibes Bot" ID 1390062 —Å–æ–∑–¥–∞–Ω –∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω
        APP->>GH: –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—é shipvibes —Å Installation ID 70719351
        Note right of APP: User access not required - –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ–Ω–æ–º–Ω–æ
        Note right of APP: –ü—Ä–∞–≤–∞ repo contents metadata webhooks
        
        Note over B: Backend —Ö—Ä–∞–Ω–∏—Ç private key GitHub App –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
        Note right of B: –ú–æ–∂–µ—Ç –ø–æ–ª—É—á–∞—Ç—å installation tokens –¥–µ–π—Å—Ç–≤—É—é—Ç 60 –º–∏–Ω—É—Ç
        Note right of B: GITHUB_APP_ID=1390062 GITHUB_APP_INSTALLATION_ID=70719351
        
        Note over U,N: üîë –ö–õ–Æ–ß–ï–í–ê–Ø –û–°–û–ë–ï–ù–ù–û–°–¢–¨ - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ù–ò–ö–û–ì–î–ê –Ω–µ –ª–æ–≥–∏–Ω–∏—Ç—Å—è –≤ GitHub
    end

    %% === 1. –°–û–ó–î–ê–ù–ò–ï –ü–†–û–ï–ö–¢–ê ===
    rect rgb(240, 248, 255)
        Note over U,N: 1Ô∏è‚É£ –°–û–ó–î–ê–ù–ò–ï –ü–†–û–ï–ö–¢–ê - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
        U->>B: –ó–∞—Ö–æ–¥–∏—Ç –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É /dashboard –≤ –±—Ä–∞—É–∑–µ—Ä–µ
        Note right of U: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç –∫–Ω–æ–ø–∫—É "Create New Project"
        
        U->>B: –ö–ª–∏–∫ –ø–æ –∫–Ω–æ–ø–∫–µ "Create New Project" —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç
        Note right of B: POST /api/projects –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∑–∞–ø—Ä–æ—Å —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞
        
        B->>DB: ProjectQueries.createProject —Å–æ–∑–¥–∞–µ—Ç –∑–∞–ø–∏—Å—å –≤ —Ç–∞–±–ª–∏—Ü–µ projects
        Note right of DB: INSERT INTO projects —Å user_id name template_type
        DB-->>B: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–æ–∑–¥–∞–Ω–Ω—ã–π –æ–±—ä–µ–∫—Ç –ø—Ä–æ–µ–∫—Ç–∞ —Å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º ID
        
        B->>APP: –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç installation token –¥–ª—è GitHub App ID 1390062
        Note right of APP: –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç JWT —Å private key –∏ –ø–æ–ª—É—á–∞–µ—Ç installation token
        APP->>APP: POST /app/installations/70719351/access_tokens —Å–æ–∑–¥–∞–µ—Ç —Ç–æ–∫–µ–Ω
        APP-->>B: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç installation_token –¥–µ–π—Å—Ç–≤—É–µ—Ç 60 –º–∏–Ω—É—Ç
        
        B->>GH: GitHub API POST /orgs/shipvibes/repos —Å–æ–∑–¥–∞–µ—Ç –ø—Ä–∏–≤–∞—Ç–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
        Note right of GH: –°–æ–∑–¥–∞–µ—Ç—Å—è –ø—Ä–∏–≤–∞—Ç–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π shipvibes-project-{projectId}
        Note right of GH: Authorization Bearer {installation_token} + auto_init true
        GH->>GH: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è —Å initial commit –∏ README –≤ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ shipvibes
        GH-->>B: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç github_repo_url clone_url –∏ repo details
        
        B->>DB: –û–±–Ω–æ–≤–ª—è–µ—Ç –ø—Ä–æ–µ–∫—Ç —Å –¥–∞–Ω–Ω—ã–º–∏ GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è —Å—Ç–∞—Ç—É—Å building
        Note right of DB: –°–æ—Ö—Ä–∞–Ω—è–µ—Ç github_repo_url github_repo_name owner + deploy_status building
        
        B->>B: –ó–∞–ø—É—Å–∫–∞–µ—Ç uploadTemplateFilesInBackground –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ
        Note right of B: Promise –≤ —Ñ–æ–Ω–µ –ë–ï–ó await –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç –æ—Ç–≤–µ—Ç API
        
        B-->>U: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—Ç–≤–µ—Ç –º–≥–Ω–æ–≤–µ–Ω–Ω–æ —Å—Ç–∞—Ç—É—Å building downloadUrl
        Note right of U: –ü–æ–ª—É—á–∞–µ—Ç –ø—Ä–æ–µ–∫—Ç —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º building + —Å—Å—ã–ª–∫—É —Å–∫–∞—á–∏–≤–∞–Ω–∏—è
        
        par –§–æ–Ω–æ–≤—ã–π –ø—Ä–æ—Ü–µ—Å—Å uploadTemplateFilesInBackground
            B->>B: generateTemplateFiles —Å–æ–∑–¥–∞–µ—Ç —Ñ–∞–π–ª—ã —à–∞–±–ª–æ–Ω–∞ –ø—Ä–æ–µ–∫—Ç–∞
            Note right of B: –ë–µ—Ä–µ—Ç —à–∞–±–ª–æ–Ω –∏–∑ –ø–∞–ø–∫–∏ templates/vite-react –∏ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –µ–≥–æ
            B->>B: –ó–∞–º–µ–Ω—è–µ—Ç __PROJECT_ID__ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–π ID –≤ shipvibes-dev.js
            
            B->>B: createMultipleFiles —á–µ—Ä–µ–∑ Git Tree API –∏–∑–±–µ–≥–∞–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤
            Note right of B: –°–æ–∑–¥–∞–µ—Ç –≤—Å–µ —Ñ–∞–π–ª—ã –æ–¥–Ω–∏–º –∫–æ–º–º–∏—Ç–æ–º —á–µ—Ä–µ–∑ Git Tree API
            
            B->>GH: GitHub API GET /repos/shipvibes/repo/git/refs/heads/main –ø–æ–ª—É—á–∞–µ—Ç parent commit
            Note right of GH: –ü–æ–ª—É—á–∞–µ—Ç SHA –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∫–æ–º–º–∏—Ç–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ –∫–æ–º–º–∏—Ç–∞
            GH-->>B: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç parent commit SHA –¥–ª—è tree API
            
            loop –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–æ–≤ —á–∞–Ω–∫–∞–º–∏ –ø–æ 5 —à—Ç—É–∫
                B->>GH: GitHub API POST /repos/shipvibes/repo/git/blobs —Å–æ–∑–¥–∞–µ—Ç 5 blobs
                Note right of GH: –°–æ–∑–¥–∞–µ—Ç blob –æ–±—ä–µ–∫—Ç—ã –¥–ª—è —á–∞–Ω–∫–∞ —Ñ–∞–π–ª–æ–≤ —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π 100ms
                GH-->>B: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç SHA –¥–ª—è –∫–∞–∂–¥–æ–≥–æ blob –æ–±—ä–µ–∫—Ç–∞ –≤ —á–∞–Ω–∫–µ
            end
            
            B->>GH: GitHub API POST /repos/shipvibes/repo/git/trees —Å–æ–∑–¥–∞–µ—Ç tree —Å–æ –≤—Å–µ–º–∏ —Ñ–∞–π–ª–∞–º–∏
            Note right of GH: –°–æ–∑–¥–∞–µ—Ç tree –æ–±—ä–µ–∫—Ç —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –≤—Å–µ —Ñ–∞–π–ª—ã –ø—Ä–æ–µ–∫—Ç–∞
            GH-->>B: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç tree SHA
            
            B->>GH: GitHub API POST /repos/shipvibes/repo/git/commits —Å–æ–∑–¥–∞–µ—Ç –µ–¥–∏–Ω—ã–π –∫–æ–º–º–∏—Ç
            Note right of GH: –°–æ–∑–¥–∞–µ—Ç –æ–¥–∏–Ω –∫–æ–º–º–∏—Ç —Å–æ –≤—Å–µ–º–∏ —Ñ–∞–π–ª–∞–º–∏ —à–∞–±–ª–æ–Ω–∞ + parent commit SHA
            GH-->>B: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç commit SHA
            
            B->>GH: GitHub API PATCH /repos/shipvibes/repo/git/refs/heads/main –æ–±–Ω–æ–≤–ª—è–µ—Ç main
            Note right of GH: –û–±–Ω–æ–≤–ª—è–µ—Ç main –≤–µ—Ç–∫—É –Ω–∞ –Ω–æ–≤—ã–π –∫–æ–º–º–∏—Ç
            GH-->>B: –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è main –≤–µ—Ç–∫–∏
            
            B->>DB: CommitHistoryQueries.createCommitHistory —Å–æ–∑–¥–∞–µ—Ç –∑–∞–ø–∏—Å—å
            Note right of DB: –°–æ—Ö—Ä–∞–Ω—è–µ—Ç commit SHA –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ñ–∞–π–ª–æ–≤ –≤ commit_history
            
            B->>B: –í development –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç ngrok.startTunnel()
            Note right of B: –°–æ–∑–¥–∞–µ—Ç –ø—É–±–ª–∏—á–Ω—ã–π URL –¥–ª—è webhooks localhost:8080 ‚Üí https://xxx.ngrok.io
            B->>B: –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç process.env.WEBSOCKET_SERVER_URL = ngrok_url
            Note right of B: –û–±–Ω–æ–≤–ª—è–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ webhook
            
            B->>DB: –û–±–Ω–æ–≤–ª—è–µ—Ç –ø—Ä–æ–µ–∫—Ç —Å—Ç–∞—Ç—É—Å pending –≥–æ—Ç–æ–≤ –∫ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ
            Note right of DB: –ù–ï —Å–æ–∑–¥–∞–µ—Ç—Å—è Netlify —Å–∞–π—Ç - deploy_status pending
            Note right of DB: Netlify —Å–∞–π—Ç –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω –ø—Ä–∏ –ø–µ—Ä–≤–æ–º Save All Changes
            
            B->>DB: CommitHistoryQueries.createCommitHistory —Å–æ–∑–¥–∞–µ—Ç –∑–∞–ø–∏—Å—å
            Note right of DB: –°–æ—Ö—Ä–∞–Ω—è–µ—Ç commit SHA –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ñ–∞–π–ª–æ–≤ –≤ commit_history
        end
        
        U->>B: –ö–ª–∏–∫ –ø–æ —Å—Å—ã–ª–∫–µ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞
        B->>B: GET /api/projects/projectId/download –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∑–∞–ø—Ä–æ—Å
        B->>GH: downloadProjectFromGitHub –ø–æ–ª—É—á–∞–µ—Ç —Å–≤–µ–∂–∏–π ZIP –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
        GH-->>B: –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ main –≤–µ—Ç–∫–∏ –∫–∞–∫ ZIP –∞—Ä—Ö–∏–≤
        B-->>U: –ë—Ä–∞—É–∑–µ—Ä —Å–∫–∞—á–∏–≤–∞–µ—Ç project.zip –Ω–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    end

    %% === 2. –õ–û–ö–ê–õ–¨–ù–ê–Ø –ù–ê–°–¢–†–û–ô–ö–ê ===
    rect rgb(250, 255, 250)
        Note over U,W: 2Ô∏è‚É£ –õ–û–ö–ê–õ–¨–ù–ê–Ø –ù–ê–°–¢–†–û–ô–ö–ê - —Ä–∞—Å–ø–∞–∫–æ–≤–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞ –∏ –∑–∞–ø—É—Å–∫ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
        U->>U: –†–∞—Å–ø–∞–∫–æ–≤—ã–≤–∞–µ—Ç ZIP –∞—Ä—Ö–∏–≤ –≤ –ø–∞–ø–∫—É –ø—Ä–æ–µ–∫—Ç–∞ –Ω–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä–µ
        Note right of U: –ü–æ–ª—É—á–∞–µ—Ç –≥–æ—Ç–æ–≤—É—é –ø–∞–ø–∫—É —Å package.json shipvibes-dev.js –∏ git remote
        
        U->>V: –û—Ç–∫—Ä—ã–≤–∞–µ—Ç –ø–∞–ø–∫—É –ø—Ä–æ–µ–∫—Ç–∞ –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ VSCode –∏–ª–∏ Cursor
        Note right of V: –†–µ–¥–∞–∫—Ç–æ—Ä –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø—Ä–æ–µ–∫—Ç–∞ –∏ –≥–æ—Ç–æ–≤ –∫ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—é
        
        U->>U: –í—ã–ø–æ–ª–Ω—è–µ—Ç –∫–æ–º–∞–Ω–¥—ã –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
        Note right of U: pnpm install —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞
        
        U->>U: –ó–∞–ø—É—Å–∫–∞–µ—Ç –∫–æ–º–∞–Ω–¥—É pnpm start –¥–ª—è —Å—Ç–∞—Ä—Ç–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
        Note right of U: –ö–æ–º–∞–Ω–¥–∞ –∑–∞–ø—É—Å–∫–∞–µ—Ç –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ pnpm dev –∏ pnpm sync
        
        Note right of U: Git –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ sync
        Note right of U: Remote origin –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –Ω–∞ GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –ø—Ä–æ–µ–∫—Ç–∞
        
        W->>W: –°–∫—Ä–∏–ø—Ç shipvibes-dev.js –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∫–æ–º–∞–Ω–¥–æ–π pnpm sync
        Note right of W: –õ–æ–∫–∞–ª—å–Ω—ã–π –∞–≥–µ–Ω—Ç –Ω–∞—á–∏–Ω–∞–µ—Ç —Ä–∞–±–æ—Ç—É —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —Å –æ–±–ª–∞–∫–æ–º
        
        W->>W: checkGitRepository –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ git —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
        Note right of W: –ï—Å–ª–∏ .git –Ω–µ –Ω–∞–π–¥–µ–Ω –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
        
        alt Git —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–µ –Ω–∞–π–¥–µ–Ω
            W->>W: initializeGitRepository –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç git
            Note right of W: git init + remote add origin –∫ GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—é –ø—Ä–æ–µ–∫—Ç–∞
            W->>W: –°–æ–∑–¥–∞–µ—Ç initial commit —Å —Ç–µ–∫—É—â–∏–º–∏ —Ñ–∞–π–ª–∞–º–∏
            Note right of W: git add . && git commit -m "Initial commit from template"
        else Git —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω
            W->>W: –ü—Ä–æ–≤–µ—Ä—è–µ—Ç remote origin
            Note right of W: –í—ã–≤–æ–¥–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω–æ–º remote
        end
        
        W->>WS: WebSocket –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ ws://localhost:8080/
        Note right of W: –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å –æ–±–ª–∞—á–Ω—ã–º —Å–µ—Ä–≤–µ—Ä–æ–º
        
        W->>WS: emit authenticate –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç projectId –∏ clientType agent
        Note right of W: –ê–≥–µ–Ω—Ç —Å–æ–æ–±—â–∞–µ—Ç —Å–µ—Ä–≤–µ—Ä—É –∫ –∫–∞–∫–æ–º—É –ø—Ä–æ–µ–∫—Ç—É –æ–Ω –æ—Ç–Ω–æ—Å–∏—Ç—Å—è
        
        WS->>WS: socket.on authenticate –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é –≤ index.ts
        Note right of WS: –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∏ –¥–æ–±–∞–≤–ª—è–µ—Ç –≤ –∫–æ–º–Ω–∞—Ç—É –ø—Ä–æ–µ–∫—Ç–∞
        
        WS->>DB: ProjectQueries.getProjectById –ø–æ–ª—É—á–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç–∞ –≤–∫–ª—é—á–∞—è GitHub repo
        Note right of DB: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç github_repo_url github_repo_name owner –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
        DB-->>WS: –û–±—ä–µ–∫—Ç –ø—Ä–æ–µ–∫—Ç–∞ —Å –ø–æ–ª—è–º–∏ github_repo_url deploy_status created_at
        
        WS->>WS: socket.join –¥–æ–±–∞–≤–ª—è–µ—Ç –≤ –∫–æ–º–Ω–∞—Ç—É project projectId
        Note right of WS: –í—Å–µ –∫–ª–∏–µ–Ω—Ç—ã –ø—Ä–æ–µ–∫—Ç–∞ –ø–æ–ª—É—á–∞—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–± –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö
        
        WS->>WS: connectedAgents.set —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç socketId –∞–≥–µ–Ω—Ç–∞
        Note right of WS: –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω—ã—Ö –∞–≥–µ–Ω—Ç–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞
        
        WS-->>W: emit authenticated –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç —É—Å–ø–µ—à–Ω—É—é –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é
        Note right of W: –ê–≥–µ–Ω—Ç –ø–æ–ª—É—á–∞–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∏ –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ
        
        WS->>B: io.to broadcast –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç agent_connected –≤—Å–µ–º –∫–ª–∏–µ–Ω—Ç–∞–º –ø—Ä–æ–µ–∫—Ç–∞
        Note right of B: –ë—Ä–∞—É–∑–µ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ–ª—É—á–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ –∞–≥–µ–Ω—Ç–∞
        
        W->>W: startFileWatcher –∑–∞–ø—É—Å–∫–∞–µ—Ç chokidar.watch —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
        Note right of W: –ù–∞—á–∏–Ω–∞–µ—Ç —Å–ª–µ–¥–∏—Ç—å –∑–∞ –≤—Å–µ–º–∏ —Ñ–∞–π–ª–∞–º–∏ –∫—Ä–æ–º–µ node_modules .git dist
    end

    %% === 3. –†–ï–î–ê–ö–¢–ò–†–û–í–ê–ù–ò–ï –ò STAGING ===
    rect rgb(255, 250, 240)
        Note over V,DB: 3Ô∏è‚É£ –†–ï–î–ê–ö–¢–ò–†–û–í–ê–ù–ò–ï –§–ê–ô–õ–û–í - –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ–ø–∞–¥–∞—é—Ç –≤ staging area pending_changes
        
        loop –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ—Ç —Ñ–∞–π–ª—ã –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ
            U->>V: –†–µ–¥–∞–∫—Ç–∏—Ä—É–µ—Ç —Ñ–∞–π–ª –Ω–∞–ø—Ä–∏–º–µ—Ä src/App.tsx –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ
            Note right of V: –í–Ω–æ—Å–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ –∏–ª–∏ —Å—Ç–∏–ª–µ–π
            
            V->>V: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç Ctrl+S –∏–ª–∏ Cmd+S –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ñ–∞–π–ª–∞
            Note right of V: –§–∞–π–ª —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –ª–æ–∫–∞–ª—å–Ω–æ–π —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
            
            V->>W: chokidar –¥–µ—Ç–µ–∫—Ç–∏—Ä—É–µ—Ç —Å–æ–±—ã—Ç–∏–µ change –Ω–∞ —Ñ–∞–π–ª–µ src/App.tsx
            Note right of W: –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ chokidar –¥–µ—Ç–µ–∫—Ç–∏—Ä—É–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–µ –≤ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
            
            W->>W: –ß–∏—Ç–∞–µ—Ç –Ω–æ–≤–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ —Å –ø–æ–º–æ—â—å—é fs.readFileSync
            Note right of W: –ü–æ–ª—É—á–∞–µ—Ç –ø–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç –∏–∑–º–µ–Ω–µ–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞
            
            W->>WS: emit file_change –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –æ –∏–∑–º–µ–Ω–µ–Ω–Ω–æ–º —Ñ–∞–π–ª–µ
            Note right of W: –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç file_path –Ω–æ–≤–æ–µ content –∏ action modified
            
            WS->>WS: socket.on file_change –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å–æ–±—ã—Ç–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ñ–∞–π–ª–∞
            Note right of WS: –ü–æ–ª—É—á–∞–µ—Ç –ø–æ–ª–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ –æ—Ç –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∞–≥–µ–Ω—Ç–∞
            
            WS->>DB: PendingChangesQueries.upsertPendingChange —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ staging area
            Note right of DB: UPSERT INTO pending_changes —Å –ø–æ–ª–Ω—ã–º content —Ñ–∞–π–ª–∞
            DB->>DB: –°–æ—Ö—Ä–∞–Ω—è–µ—Ç project_id file_path content action modified timestamp
            
            WS->>B: io.to projectId emit file_change_staged —É–≤–µ–¥–æ–º–ª—è–µ—Ç –í–°–ï –∫–ª–∏–µ–Ω—Ç—ã –ø—Ä–æ–µ–∫—Ç–∞
            Note right of B: –ë—Ä–∞—É–∑–µ—Ä –ø–æ–ª—É—á–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –≤ staging area
            
            B->>B: UI –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å—á–µ—Ç—á–∏–∫ –Ω–µ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π
            Note right of B: –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç "3 unsaved changes" –∏ –∫–Ω–æ–ø–∫–∏ Save All / Discard All
        end
    end

    %% === 4. DISCARD ALL CHANGES ===
    rect rgb(255, 240, 240)
        Note over U,W: 4Ô∏è‚É£ –û–¢–ú–ï–ù–ê –í–°–ï–• –ò–ó–ú–ï–ù–ï–ù–ò–ô - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –æ—Ç–∫–∞—Ç–∏—Ç—å –≤—Å–µ –Ω–µ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
        
        alt –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç "Discard All Changes" –≤ –±—Ä–∞—É–∑–µ—Ä–µ
            U->>B: –ö–ª–∏–∫ –ø–æ –∫–Ω–æ–ø–∫–µ "Discard All Changes" –≤ –≤–µ–± –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ
            Note right of B: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ö–æ—á–µ—Ç –æ—Ç–∫–∞—Ç–∏—Ç—å –≤—Å–µ –Ω–µ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
            
            B->>WS: POST /api/projects/projectId/discard –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∫–æ–º–∞–Ω–¥—É –æ—Ç–∫–∞—Ç–∞
            Note right of B: –í–µ–± –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø—Ä–æ—Å–∏—Ç WebSocket —Å–µ—Ä–≤–µ—Ä –≤—ã–ø–æ–ª–Ω–∏—Ç—å –æ—Ç–∫–∞—Ç
            
            WS->>DB: PendingChangesQueries.clearAllPendingChanges –æ—á–∏—â–∞–µ—Ç staging area
            Note right of DB: DELETE FROM pending_changes WHERE project_id = projectId
            DB->>DB: –£–¥–∞–ª—è–µ—Ç –≤—Å–µ –Ω–µ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
            
            WS->>W: emit discard_local_changes –∫–æ–º–∞–Ω–¥–∞ –ª–æ–∫–∞–ª—å–Ω–æ–º—É –∞–≥–µ–Ω—Ç—É
            Note right of W: –°–µ—Ä–≤–µ—Ä –ø—Ä–æ—Å–∏—Ç –ª–æ–∫–∞–ª—å–Ω—ã–π –∞–≥–µ–Ω—Ç –æ—Ç–∫–∞—Ç–∏—Ç—å —Ñ–∞–π–ª—ã
            
            W->>W: –í—ã–ø–æ–ª–Ω—è–µ—Ç git reset --hard HEAD –ª–æ–∫–∞–ª—å–Ω–æ
            Note right of W: –û—Ç–∫–∞—Ç—ã–≤–∞–µ—Ç –≤—Å–µ –ª–æ–∫–∞–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã –∫ –ø–æ—Å–ª–µ–¥–Ω–µ–º—É –∫–æ–º–º–∏—Ç—É –ë–ï–ó –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
            
            W->>W: –í—ã–ø–æ–ª–Ω—è–µ—Ç git clean -fd –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –Ω–µ–æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤
            Note right of W: –£–¥–∞–ª—è–µ—Ç –Ω–æ–≤—ã–µ —Ñ–∞–π–ª—ã –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –±—ã–ª–∏ –≤ –ø–æ—Å–ª–µ–¥–Ω–µ–º –∫–æ–º–º–∏—Ç–µ
            
            W-->>WS: emit discard_completed –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ—Ç–∫–∞—Ç–∞
            Note right of WS: –õ–æ–∫–∞–ª—å–Ω—ã–π –∞–≥–µ–Ω—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç —É—Å–ø–µ—à–Ω—ã–π –æ—Ç–∫–∞—Ç —Ñ–∞–π–ª–æ–≤
            
            WS->>B: io.to projectId emit discard_success —É–≤–µ–¥–æ–º–ª—è–µ—Ç –í–°–ï –∫–ª–∏–µ–Ω—Ç—ã –ø—Ä–æ–µ–∫—Ç–∞  
            Note right of B: –ë—Ä–∞—É–∑–µ—Ä –ø–æ–ª—É—á–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± –æ—á–∏—Å—Ç–∫–µ pending changes
            
            B->>B: UI —Å–∫—Ä—ã–≤–∞–µ—Ç –∫–Ω–æ–ø–∫–∏ Save All –∏ Discard All
            Note right of B: –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —á—Ç–æ –Ω–µ—Ç –Ω–µ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π
        end
    end

    %% === 5. SAVE ALL CHANGES (COMMIT) ===
    rect rgb(240, 255, 240)
        Note over U,N: 5Ô∏è‚É£ –°–û–•–†–ê–ù–ï–ù–ò–ï –í–°–ï–• –ò–ó–ú–ï–ù–ï–ù–ò–ô - —Å–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–º–∏—Ç–∞ —á–µ—Ä–µ–∑ GitHub App
        
        alt –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç "Save All Changes" –≤ –±—Ä–∞—É–∑–µ—Ä–µ
            U->>B: –ö–ª–∏–∫ –ø–æ –∫–Ω–æ–ø–∫–µ "Save All Changes" –¥–ª—è –∫–æ–º–º–∏—Ç–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π
            Note right of B: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ö–æ—á–µ—Ç —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ GitHub
            
            B->>WS: POST /api/projects/projectId/commit –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∫–æ–º–∞–Ω–¥—É –∫–æ–º–º–∏—Ç–∞
            Note right of B: –í–µ–± –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø—Ä–æ—Å–∏—Ç —Å–æ–∑–¥–∞—Ç—å –∫–æ–º–º–∏—Ç –≤—Å–µ—Ö pending changes
            
            WS->>DB: PendingChangesQueries.getAllPendingChanges –ø–æ–ª—É—á–∞–µ—Ç –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
            Note right of DB: SELECT * FROM pending_changes WHERE project_id = projectId
            DB-->>WS: –ú–∞—Å—Å–∏–≤ –æ–±—ä–µ–∫—Ç–æ–≤ —Å file_path content action –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ñ–∞–π–ª–∞
            
            WS->>APP: –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –Ω–æ–≤—ã–π installation token –¥–ª—è GitHub App ID 1390062
            Note right of APP: –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å–≤–µ–∂–∏–π installation token –¥–µ–π—Å—Ç–≤—É–µ—Ç 60 –º–∏–Ω—É—Ç
            APP-->>WS: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç installation_token –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –≤ GitHub
            
            WS->>DB: ProjectQueries.getProjectById –ø–æ–ª—É—á–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
            Note right of DB: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç github_repo_url owner repo_name –¥–ª—è –∫–æ–º–º–∏—Ç–∞
            DB-->>WS: –û–±—ä–µ–∫—Ç –ø—Ä–æ–µ–∫—Ç–∞ —Å github_repo_url owner shipvibes repo_name
            
            alt –ü–µ—Ä–≤—ã–π –∫–æ–º–º–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–Ω–µ—Ç netlify_site_id)
                WS->>N: Netlify API POST /sites —Å–æ–∑–¥–∞–µ—Ç —Å–∞–π—Ç —Å GitHub –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π
                Note right of N: –°–æ–∑–¥–∞–µ—Ç Netlify —Å–∞–π—Ç –ø—Ä–∏–≤—è–∑–∞–Ω–Ω—ã–π –∫ GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—é
                N->>N: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç build settings –∏ deploy key
                N-->>WS: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç netlify_site_id –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ –ë–î
                
                WS->>DB: ProjectQueries.updateProject —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç netlify_site_id
                Note right of DB: –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç netlify_site_id + deploy_status building
                
                WS->>N: setupWebhookForSite –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç webhooks –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
                Note right of N: –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç webhook –¥–ª—è —Å–æ–±—ã—Ç–∏–π deploy_created deploy_building deploy_failed
            end
            
            loop –î–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞
                WS->>GH: GitHub API PUT /repos/shipvibes/repo/contents/filePath
                Note right of GH: –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ü–û–õ–ù–û–ï –°–û–î–ï–†–ñ–ò–ú–û–ï —Ñ–∞–π–ª–∞ —á–µ—Ä–µ–∑ GitHub App —Ç–æ–∫–µ–Ω
                Note right of GH: Authorization Bearer {installation_token}
                GH-->>WS: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–æ–≤—ã–π sha —Ñ–∞–π–ª–∞ –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏
            end
            
            WS->>GH: GitHub API POST /repos/shipvibes/repo/git/refs/heads/main –æ–±–Ω–æ–≤–ª—è–µ—Ç main
            Note right of GH: –°–æ–∑–¥–∞–µ—Ç—Å—è –æ–¥–∏–Ω –∫–æ–º–º–∏—Ç "Save project changes" —Å–æ –≤—Å–µ–º–∏ —Ñ–∞–π–ª–∞–º–∏
            GH->>GH: –ö–æ–º–º–∏—Ç –ø–æ—è–≤–ª—è–µ—Ç—Å—è –≤ main –≤–µ—Ç–∫–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ shipvibes
            GH-->>WS: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç sha –∫–æ–º–º–∏—Ç–∞ commit_url –∏ tree_sha
            
            WS->>DB: FileHistoryQueries.createCommitRecord —Å–æ–∑–¥–∞–µ—Ç –∑–∞–ø–∏—Å—å –æ –∫–æ–º–º–∏—Ç–µ
            Note right of DB: –°–æ—Ö—Ä–∞–Ω—è–µ—Ç sha –∫–æ–º–º–∏—Ç–∞ commit_message –≤ commit_history
            DB->>DB: INSERT INTO commit_history —Å github_commit_sha –∏ github_commit_url
            
            WS->>DB: PendingChangesQueries.clearAllPendingChanges –æ—á–∏—â–∞–µ—Ç staging area
            Note right of DB: –£–¥–∞–ª—è–µ—Ç –≤—Å–µ –∑–∞–ø–∏—Å–∏ –∏–∑ pending_changes —Ç–∞–∫ –∫–∞–∫ –æ–Ω–∏ –∑–∞–∫–æ–º–º–∏—á–µ–Ω—ã
            DB->>DB: DELETE FROM pending_changes WHERE project_id equals projectId
            
            WS->>W: emit pull_latest_changes –∫–æ–º–∞–Ω–¥–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —Å GitHub
            Note right of W: –ü—Ä–æ—Å–∏—Ç –ª–æ–∫–∞–ª—å–Ω—ã–π –∞–≥–µ–Ω—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å –Ω–æ–≤—ã–º –∫–æ–º–º–∏—Ç–æ–º
            
            alt –õ–æ–∫–∞–ª—å–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ git pull
                WS->>APP: –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –≤—Ä–µ–º–µ–Ω–Ω—ã–π installation token –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ git pull
                APP-->>WS: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤—Ä–µ–º–µ–Ω–Ω—ã–π —Ç–æ–∫–µ–Ω –¥–µ–π—Å—Ç–≤—É–µ—Ç 60 –º–∏–Ω—É—Ç
                
                WS->>W: emit git_pull_with_token –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≤—Ä–µ–º–µ–Ω–Ω—ã–π —Ç–æ–∫–µ–Ω –∞–≥–µ–Ω—Ç—É
                Note right of W: –ü–æ–ª—É—á–∞–µ—Ç –±–µ–∑–æ–ø–∞—Å–Ω—ã–π —Ç–æ–∫–µ–Ω –¥–ª—è –æ–¥–Ω–æ—Ä–∞–∑–æ–≤–æ–≥–æ git pull
                
                W->>W: –í—ã–ø–æ–ª–Ω—è–µ—Ç git pull —Å —Ç–æ–∫–µ–Ω–æ–º –≤ URL
                Note right of W: git pull https://x-access-token:{token}@github.com/shipvibes/repo.git
                W-->>WS: emit pull_completed –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
            else –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ - –ø–µ—Ä–µ–∑–∞–ø–∏—Å—å —Ñ–∞–π–ª–æ–≤ —á–µ—Ä–µ–∑ WebSocket
                WS->>GH: GitHub API GET /repos/shipvibes/repo/contents –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
                GH-->>WS: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∞–∫—Ç—É–∞–ª—å–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–æ–≤ –∏–∑ GitHub
                
                WS->>W: emit update_local_files –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–æ–≤–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–æ–≤
                Note right of W: –õ–æ–∫–∞–ª—å–Ω—ã–π –∞–≥–µ–Ω—Ç –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç —Ñ–∞–π–ª—ã –Ω–æ–≤—ã–º —Å–æ–¥–µ—Ä–∂–∏–º—ã–º
                W-->>WS: emit files_updated –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤
            end
            
            WS->>B: io.to projectId emit save_success —É–≤–µ–¥–æ–º–ª—è–µ—Ç –í–°–ï –∫–ª–∏–µ–Ω—Ç—ã –ø—Ä–æ–µ–∫—Ç–∞ –æ –∫–æ–º–º–∏—Ç–µ
            Note right of B: –ë—Ä–∞—É–∑–µ—Ä –ø–æ–ª—É—á–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –∏ –æ—á–∏—Å—Ç–∫–µ pending changes
            
            B->>B: UI –æ–±–Ω–æ–≤–ª—è–µ—Ç –∏—Å—Ç–æ—Ä–∏—é –∫–æ–º–º–∏—Ç–æ–≤ –∏ –æ—á–∏—â–∞–µ—Ç pending changes
            Note right of B: –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–æ–≤—ã–π –∫–æ–º–º–∏—Ç –≤ –∏—Å—Ç–æ—Ä–∏–∏ –∏ —É–±–∏—Ä–∞–µ—Ç —Å—á–µ—Ç—á–∏–∫ –∏–∑–º–µ–Ω–µ–Ω–∏–π
        end
    end

    %% === 6. –ê–í–¢–û–î–ï–ü–õ–û–ô ===
    rect rgb(255, 248, 240)
        Note over GH,B: 6Ô∏è‚É£ –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ò–ô –î–ï–ü–õ–û–ô - Netlify –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–µ–ø–ª–æ–∏—Ç –Ω–æ–≤—ã–π –∫–æ–º–º–∏—Ç
        
        GH->>N: GitHub webhook —É–≤–µ–¥–æ–º–ª—è–µ—Ç Netlify –æ –Ω–æ–≤–æ–º –∫–æ–º–º–∏—Ç–µ –≤ main
        Note right of GH: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–∑–æ–≤ webhook –ø—Ä–∏ push –≤ main –≤–µ—Ç–∫—É
        Note right of GH: Netlify —É–∂–µ –∏–º–µ–µ—Ç deploy key –¥–ª—è —á—Ç–µ–Ω–∏—è –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ —Ä–µ–ø–æ
        
        N->>N: Netlify –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç build –ø—Ä–æ—Ü–µ—Å—Å
        Note right of N: –°–∫–∞—á–∏–≤–∞–µ—Ç –∫–æ–¥ –∏–∑ –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ GitHub —Ä–µ–ø–æ –∏—Å–ø–æ–ª—å–∑—É—è deploy key
        
        N->>GH: –°–∫–∞—á–∏–≤–∞–µ—Ç –∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ –∏–∑ –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
        Note right of GH: Netlify –ø–æ–ª—É—á–∞–µ—Ç –¥–æ—Å—Ç—É–ø –∫ –Ω–æ–≤–æ–º—É –∫–æ–º–º–∏—Ç—É —á–µ—Ä–µ–∑ deploy key
        
        N->>N: –í—ã–ø–æ–ª–Ω—è–µ—Ç –∫–æ–º–∞–Ω–¥—ã build –∏–∑ –Ω–∞—Å—Ç—Ä–æ–µ–∫ —Å–∞–π—Ç–∞
        Note right of N: pnpm install && pnpm build —Å–æ–∑–¥–∞–µ—Ç production –≤–µ—Ä—Å–∏—é
        
        alt –°–±–æ—Ä–∫–∞ —É—Å–ø–µ—à–Ω–∞
            N->>N: –î–µ–ø–ª–æ–∏—Ç —Å–æ–±—Ä–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –Ω–∞ CDN
            Note right of N: –ü—É–±–ª–∏–∫—É–µ—Ç –Ω–æ–≤—É—é –≤–µ—Ä—Å–∏—é —Å–∞–π—Ç–∞
            
            N->>WS: POST /webhooks/netlify —É–≤–µ–¥–æ–º–ª—è–µ—Ç –æ —É—Å–ø–µ—à–Ω–æ–º –¥–µ–ø–ª–æ–µ
            Note right of N: –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç webhook –æ —Å—Ç–∞—Ç—É—Å–µ –¥–µ–ø–ª–æ—è –ò —Ñ–∏–Ω–∞–ª—å–Ω—ã–π URL —Å–∞–π—Ç–∞
            
            WS->>DB: ProjectQueries.updateProject —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç deploy_status ready + netlify_url
            Note right of DB: –û–±–Ω–æ–≤–ª—è–µ—Ç —Å—Ç–∞—Ç—É—Å –¥–µ–ø–ª–æ—è –ò –°–û–•–†–ê–ù–Ø–ï–¢ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π URL –≤–ø–µ—Ä–≤—ã–µ
            
            WS->>B: io.to projectId emit deploy_status_update —É–≤–µ–¥–æ–º–ª—è–µ—Ç –±—Ä–∞—É–∑–µ—Ä
            Note right of B: –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∑–µ–ª–µ–Ω—ã–π —Å—Ç–∞—Ç—É—Å "Deployed successfully"
            
        else –°–±–æ—Ä–∫–∞ –ø—Ä–æ–≤–∞–ª–∏–ª–∞—Å—å
            N->>WS: POST /webhooks/netlify —É–≤–µ–¥–æ–º–ª—è–µ—Ç –æ–± –æ—à–∏–±–∫–µ —Å–±–æ—Ä–∫–∏
            Note right of N: –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –¥–µ—Ç–∞–ª–∏ –æ—à–∏–±–∫–∏ build logs
            
            WS->>DB: ProjectQueries.updateProject —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç deploy_status failed
            Note right of DB: –ü–æ–º–µ—á–∞–µ—Ç –¥–µ–ø–ª–æ–π –∫–∞–∫ –Ω–µ—É–¥–∞—á–Ω—ã–π
            
            WS->>B: io.to projectId emit deploy_status_update —É–≤–µ–¥–æ–º–ª—è–µ—Ç –æ–± –æ—à–∏–±–∫–µ
            Note right of B: –ë—Ä–∞—É–∑–µ—Ä –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –ø—Ä–æ–±–ª–µ–º–µ
        end
    end

    %% === 7. –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –í–û–ó–ú–û–ñ–ù–û–°–¢–ò ===
    rect rgb(248, 248, 255)
        Note over U,B: 7Ô∏è‚É£ –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –í–û–ó–ú–û–ñ–ù–û–°–¢–ò - –ø—Ä–æ—Å–º–æ—Ç—Ä –∏—Å—Ç–æ—Ä–∏–∏ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–æ–º
        
        U->>B: –û—Ç–∫—Ä—ã–≤–∞–µ—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—É –∏—Å—Ç–æ—Ä–∏–∏ –∫–æ–º–º–∏—Ç–æ–≤ –ø—Ä–æ–µ–∫—Ç–∞
        Note right of B: GET /project/projectId/file-history –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤—Å–µ –∫–æ–º–º–∏—Ç—ã
        
        B->>DB: CommitHistoryQueries.getProjectCommits –ø–æ–ª—É—á–∞–µ—Ç –∏—Å—Ç–æ—Ä–∏—é
        Note right of DB: SELECT * FROM commit_history WHERE project_id ORDER BY created_at
        DB-->>B: –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∫–æ–º–º–∏—Ç–æ–≤ —Å sha timestamp commit_message
        
        B-->>U: –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç timeline –∫–æ–º–º–∏—Ç–æ–≤ —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ diff
        Note right of U: –ú–æ–∂–µ—Ç –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —á—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å –≤ –∫–∞–∂–¥–æ–º –∫–æ–º–º–∏—Ç–µ
        
        U->>B: –ö–ª–∏–∫ –ø–æ –∫–Ω–æ–ø–∫–µ "Open Live Site" –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –¥–µ–ø–ª–æ—è
        Note right of B: –û—Ç–∫—Ä—ã–≤–∞–µ—Ç Netlify URL –≤ –Ω–æ–≤–æ–π –≤–∫–ª–∞–¥–∫–µ –±—Ä–∞—É–∑–µ—Ä–∞
        
        U->>B: –ö–ª–∏–∫ –ø–æ –∫–Ω–æ–ø–∫–µ "View on GitHub" –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
        Note right of B: –û—Ç–∫—Ä—ã–≤–∞–µ—Ç GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π shipvibes-app/shipvibes-project-{id}
        B-->>U: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç –ø—Ä–∏–≤–∞—Ç–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–æ –ù–ï –º–æ–∂–µ—Ç –≤ –Ω–µ–≥–æ –ø—É—à–∏—Ç—å
        Note right of U: –ü–æ–ª–Ω–∞—è –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏–π —á–µ—Ä–µ–∑ GitHub –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
        
        Note over U,B: üí° –ö–õ–Æ–ß–ï–í–´–ï –û–°–û–ë–ï–ù–ù–û–°–¢–ò –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã
        Note right of U: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ù–ò–ö–û–ì–î–ê –Ω–µ –ª–æ–≥–∏–Ω–∏—Ç—Å—è –≤ GitHub
        Note right of U: –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å GitHub –≤—ã–ø–æ–ª–Ω—è–µ—Ç –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ —á–µ—Ä–µ–∑ GitHub App
        Note right of U: –ü—Ä–∏–≤–∞—Ç–Ω—ã–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –≤ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ shipvibes
        Note right of U: Netlify –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω —Å deploy keys –¥–ª—è —á—Ç–µ–Ω–∏—è
        Note right of U: –ö–æ–º–º–∏—Ç –≤ main = —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ + –∞–≤—Ç–æ–¥–µ–ø–ª–æ–π
        Note right of U: Staging area –ø–æ–∑–≤–æ–ª—è–µ—Ç –Ω–∞–∫–∞–ø–ª–∏–≤–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏ –æ—Ç–∫–∞—Ç—ã–≤–∞—Ç—å –∏—Ö
        Note right of U: –õ–æ–∫–∞–ª—å–Ω—ã–π git reset —Ä–∞–±–æ—Ç–∞–µ—Ç –ë–ï–ó –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –¥–ª—è –æ—Ç–∫–∞—Ç–∞
    end

    %% === 8. –£–î–ê–õ–ï–ù–ò–ï –ü–†–û–ï–ö–¢–ê ===
    rect rgb(255, 235, 235)
        Note over U,N: 8Ô∏è‚É£ –ü–û–õ–ù–û–ï –£–î–ê–õ–ï–ù–ò–ï –ü–†–û–ï–ö–¢–ê - –æ—á–∏—Å—Ç–∫–∞ –≤—Å–µ—Ö —Ä–µ—Å—É—Ä—Å–æ–≤ –≤–æ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–∞—Ö
        
        U->>B: –ü–µ—Ä–µ—Ö–æ–¥–∏—Ç –≤ Settings –ø—Ä–æ–µ–∫—Ç–∞ –∏ –Ω–∞–∂–∏–º–∞–µ—Ç "Delete Project"
        Note right of B: GET /project/projectId/settings –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
        Note right of U: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç –∫—Ä–∞—Å–Ω—É—é Danger Zone —Å –∫–Ω–æ–ø–∫–æ–π —É–¥–∞–ª–µ–Ω–∏—è
        
        U->>B: –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç —É–¥–∞–ª–µ–Ω–∏–µ –≤ –º–æ–¥–∞–ª—å–Ω–æ–º –æ–∫–Ω–µ
        Note right of U: –ë—Ä–∞—É–∑–µ—Ä –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ –Ω–µ–æ–±—Ä–∞—Ç–∏–º–æ—Å—Ç–∏ –æ–ø–µ—Ä–∞—Ü–∏–∏
        
        B->>B: DELETE /api/projects/projectId –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∑–∞–ø—Ä–æ—Å —É–¥–∞–ª–µ–Ω–∏—è
        Note right of B: –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –ø—Ä–∞–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —á–µ—Ä–µ–∑ RLS –≤ Supabase
        
        B->>DB: ProjectQueries.getProjectById –ø–æ–ª—É—á–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç–∞
        Note right of DB: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–±—ä–µ–∫—Ç —Å netlify_site_id github_repo_name –¥–ª—è –æ—á–∏—Å—Ç–∫–∏
        DB-->>B: –ü—Ä–æ–µ–∫—Ç —Å –ø–æ–ª–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –≤—Å–µ—Ö —Ä–µ—Å—É—Ä—Å–æ–≤
        
        alt –ï—Å—Ç—å Netlify —Å–∞–π—Ç –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è
            B->>N: DELETE /api/v1/sites/{netlify_site_id} —É–¥–∞–ª—è–µ—Ç Netlify —Å–∞–π—Ç
            Note right of N: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è NETLIFY_ACCESS_TOKEN –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
            N->>N: –£–¥–∞–ª—è–µ—Ç –∂–∏–≤–æ–π —Å–∞–π—Ç DNS –∑–∞–ø–∏—Å–∏ CDN –∫—ç—à webhooks
            N-->>B: –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–∏—è —Å–∞–π—Ç–∞ –∏–ª–∏ 404 –µ—Å–ª–∏ —É–∂–µ —É–¥–∞–ª–µ–Ω
            Note right of B: –õ–æ–≥–∏—Ä—É–µ—Ç —É—Å–ø–µ—Ö –∏–ª–∏ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –µ—Å–ª–∏ —Å–∞–π—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω
        else –ù–µ—Ç Netlify —Å–∞–π—Ç–∞
            Note right of B: –ü—Ä–æ–ø—É—Å–∫–∞–µ—Ç —É–¥–∞–ª–µ–Ω–∏–µ Netlify —Ç–∞–∫ –∫–∞–∫ netlify_site_id –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç
        end
        
        alt –ï—Å—Ç—å GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è  
            B->>APP: –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç installation token –¥–ª—è GitHub App ID 1390062
            Note right of APP: –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç JWT –∏ –ø–æ–ª—É—á–∞–µ—Ç installation token –Ω–∞ 60 –º–∏–Ω—É—Ç
            APP-->>B: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç installation_token –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —É–¥–∞–ª–µ–Ω–∏—è
            
            B->>GH: DELETE /repos/shipvibes/{github_repo_name} —É–¥–∞–ª—è–µ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
            Note right of GH: Authorization Bearer {installation_token}
            Note right of GH: –ü–æ–ª–Ω–æ—Å—Ç—å—é —É–¥–∞–ª—è–µ—Ç –ø—Ä–∏–≤–∞—Ç–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∏–∑ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏
            GH->>GH: –£–¥–∞–ª—è–µ—Ç –≤—Å–µ —Ñ–∞–π–ª—ã –∏—Å—Ç–æ—Ä–∏—é –∫–æ–º–º–∏—Ç–æ–≤ issues PR webhooks
            GH-->>B: –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–∏—è –∏–ª–∏ 404 –µ—Å–ª–∏ —Ä–µ–ø–æ –Ω–µ –Ω–∞–π–¥–µ–Ω
            Note right of B: –õ–æ–≥–∏—Ä—É–µ—Ç —É—Å–ø–µ—Ö –∏–ª–∏ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –µ—Å–ª–∏ —Ä–µ–ø–æ —É–∂–µ —É–¥–∞–ª–µ–Ω
        else –ù–µ—Ç GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
            Note right of B: –ü—Ä–æ–ø—É—Å–∫–∞–µ—Ç —É–¥–∞–ª–µ–Ω–∏–µ GitHub —Ç–∞–∫ –∫–∞–∫ github_repo_name –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç  
        end
        
        B->>DB: ProjectQueries.deleteProject —É–¥–∞–ª—è–µ—Ç –ø—Ä–æ–µ–∫—Ç –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
        Note right of DB: DELETE FROM projects WHERE id = projectId AND user_id = auth.uid()
        
        DB->>DB: –ö–∞—Å–∫–∞–¥–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ foreign key constraints
        Note right of DB: AUTO DELETE FROM file_history WHERE project_id = projectId
        Note right of DB: AUTO DELETE FROM commit_history WHERE project_id = projectId  
        Note right of DB: AUTO DELETE FROM pending_changes WHERE project_id = projectId
        
        DB-->>B: –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–æ–ª–Ω–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞ –∏ –≤—Å–µ—Ö —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
        
        B-->>U: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —É—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç –∏ —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
        Note right of U: –ë—Ä–∞—É–∑–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–∞ /dashboard
        
        alt –ï—Å–ª–∏ WebSocket –∞–≥–µ–Ω—Ç –±—ã–ª –ø–æ–¥–∫–ª—é—á–µ–Ω
            WS->>W: –ü–æ–ª—É—á–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ —Ç–æ–º —á—Ç–æ –ø—Ä–æ–µ–∫—Ç —É–¥–∞–ª–µ–Ω
            Note right of W: –õ–æ–∫–∞–ª—å–Ω—ã–π –∞–≥–µ–Ω—Ç —Ç–µ—Ä—è–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Ç–∞–∫ –∫–∞–∫ –ø—Ä–æ–µ–∫—Ç –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
            
            W->>W: –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç file watcher –∏ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ  
            Note right of W: –ü—Ä–µ–∫—Ä–∞—â–∞–µ—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é
            
            W-->>U: –í—ã–≤–æ–¥–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ "Project deleted remotely connection closed"
            Note right of U: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ —á—Ç–æ –ø—Ä–æ–µ–∫—Ç —É–¥–∞–ª–µ–Ω —É–¥–∞–ª–µ–Ω–Ω–æ
        end
        

    end