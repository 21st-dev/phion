---
description: 
globs: 
alwaysApply: true
---
## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ Shipvibes

–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–≤ –∫–æ–¥ –ø—Ä–æ–µ–∫—Ç–∞, —è –º–æ–≥—É —Å–æ—Å—Ç–∞–≤–∏—Ç—å –ø–æ–ª–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –æ —Ç–æ–º, –∫–∞–∫ —É—Å—Ç—Ä–æ–µ–Ω–∞ —ç—Ç–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥-–∫–æ–¥–∞ —Å –∞–≤—Ç–æ–¥–µ–ø–ª–æ–µ–º.

### –û–±—â–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

Shipvibes - —ç—Ç–æ –º–æ–Ω–æ—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π, –ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –Ω–∞ –±–∞–∑–µ **Turbo.build** –∏ **pnpm workspace**, —Å–æ—Å—Ç–æ—è—â–∏–π –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö –æ—Å–Ω–æ–≤–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:
### üèóÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

#### **Apps (–ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è)**
- **`apps/web/`** - –í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ Next.js (–ø–æ—Ä—Ç 3004)
  - –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞–º–∏ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
  - API –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–æ–≤, —Å–∫–∞—á–∏–≤–∞–Ω–∏—è —à–∞–±–ª–æ–Ω–æ–≤
  - –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∏—Å—Ç–æ—Ä–∏–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π
  - –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ Supabase

- **`apps/websocket-server/`** - WebSocket —Å–µ—Ä–≤–µ—Ä –Ω–∞ Express + Socket.IO (–ø–æ—Ä—Ç 8080)
  - –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π —Ñ–∞–π–ª–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
  - –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å Netlify –¥–ª—è –∞–≤—Ç–æ–¥–µ–ø–ª–æ—è
  - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–µ—Ä—Å–∏—è–º–∏ –∏ –∫–æ–º–º–∏—Ç–∞–º–∏

#### **Packages (–û–±—â–∏–µ –ø–∞–∫–µ—Ç—ã)**
- **`packages/shared/`** - –û–±—â–∏–µ —Ç–∏–ø—ã –∏ —É—Ç–∏–ª–∏—Ç—ã (Zod-—Å—Ö–µ–º—ã)
- **`packages/database/`** - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Supabase (queries, client)
- **`packages/storage/`** - –†–∞–±–æ—Ç–∞ —Å Cloudflare R2 (—Ñ–∞–π–ª–æ–≤–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ)

#### **Templates (–®–∞–±–ª–æ–Ω—ã)**
- **`templates/vite-react/`** - –ì–æ—Ç–æ–≤—ã–π —à–∞–±–ª–æ–Ω –ø—Ä–æ–µ–∫—Ç–∞ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
  - –í–∫–ª—é—á–∞–µ—Ç `shipvibes-dev.js` - –ª–æ–∫–∞–ª—å–Ω—ã–π –∞–≥–µ–Ω—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
  - –ù–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π Vite + React + TypeScript + shadcn/ui

### üîÑ Workflow –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

#### 1. **–°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞**
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞—Ö–æ–¥–∏—Ç –Ω–∞ –≤–µ–±-–ø–æ—Ä—Ç–∞–ª (Next.js app)
- –°–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç, –≤—ã–±–∏—Ä–∞—è —à–∞–±–ª–æ–Ω
- –°–∏—Å—Ç–µ–º–∞ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç ZIP-–∞—Ä—Ö–∏–≤ —Å –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–º —à–∞–±–ª–æ–Ω–æ–º
- –í `shipvibes-dev.js` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è PROJECT_ID

#### 2. **–õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞**
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–∫–∞—á–∏–≤–∞–µ—Ç ZIP, —Ä–∞—Å–ø–∞–∫–æ–≤—ã–≤–∞–µ—Ç
- –ó–∞–ø—É—Å–∫–∞–µ—Ç `pnpm start` —á—Ç–æ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ:
  - –ó–∞–ø—É—Å–∫–∞–µ—Ç `pnpm dev` (Vite dev server –Ω–∞ localhost:5173)
  - –ó–∞–ø—É—Å–∫–∞–µ—Ç `pnpm sync` (–ª–æ–∫–∞–ª—å–Ω—ã–π –∞–≥–µ–Ω—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏)

#### 3. **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏**
- **File Watcher** (chokidar) –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤
- –ü—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ —Ñ–∞–π–ª–∞ ‚Üí WebSocket –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
- –°–µ—Ä–≤–µ—Ä —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ **pending_changes** (–Ω–µ –¥–µ–ª–∞–µ—Ç –∫–æ–º–º–∏—Ç)
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –ª–æ–∫–∞–ª—å–Ω–æ —Å—Ä–∞–∑—É

#### 4. **–°–∏—Å—Ç–µ–º–∞ –∫–æ–º–º–∏—Ç–æ–≤ –∏ –¥–µ–ø–ª–æ—è**
- –ï—Å—Ç—å HTTP API –¥–ª—è —Ä—É—á–Ω–æ–≥–æ –¥–µ–ø–ª–æ—è: `POST /api/deploy`
- –ü—Ä–∏ –¥–µ–ø–ª–æ–µ —Å–æ–∑–¥–∞–µ—Ç—Å—è –ø–æ–ª–Ω—ã–π —Å–Ω–∞–ø—à–æ—Ç –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤ –ø—Ä–æ–µ–∫—Ç–∞
- –í—Å–µ pending changes —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –∫–∞–∫ –æ–¥–∏–Ω –∫–æ–º–º–∏—Ç –≤ file_history
- –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π –Ω–∞ Netlify

### üèóÔ∏è –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

#### **Frontend**
- **Next.js 15** - –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
- **React 18** - –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã UI
- **Tailwind CSS** - —Å—Ç–∏–ª–∏–∑–∞—Ü–∏—è
- **shadcn/ui** - –≥–æ—Ç–æ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
- **Radix UI** - –ø—Ä–∏–º–∏—Ç–∏–≤—ã
- **TanStack Query** - state management

#### **Backend**
- **Node.js + Express** - WebSocket —Å–µ—Ä–≤–µ—Ä
- **Socket.IO** - real-time –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è
- **Supabase** - –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
- **Cloudflare R2** - –æ–±—ä–µ–∫—Ç–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ —Ñ–∞–π–ª–æ–≤

#### **DevOps & –î–µ–ø–ª–æ–π**
- **Netlify API** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π
- **Vite** - —Å–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- **pnpm** - package manager
- **Turbo.build** - –º–æ–Ω–æ—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π

### üóÑÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

#### **–û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã (Supabase)**
- **`projects`** - –ø—Ä–æ–µ–∫—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- **`file_history`** - –∏—Å—Ç–æ—Ä–∏—è –≤–µ—Ä—Å–∏–π —Ñ–∞–π–ª–æ–≤ (–∫–æ–º–º–∏—Ç—ã)
- **`pending_changes`** - –Ω–µ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
- **`deploy_status`** - —Å—Ç–∞—Ç—É—Å—ã –¥–µ–ø–ª–æ–µ–≤

#### **–§–∞–π–ª–æ–≤–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ (Cloudflare R2)**
```
projects/
  ‚îú‚îÄ‚îÄ {projectId}/
  ‚îÇ   ‚îú‚îÄ‚îÄ templates/
  ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ project.zip  # –ò—Å—Ö–æ–¥–Ω—ã–π —à–∞–±–ª–æ–Ω
  ‚îÇ   ‚îî‚îÄ‚îÄ versions/
  ‚îÇ       ‚îî‚îÄ‚îÄ {commitId}/
  ‚îÇ           ‚îú‚îÄ‚îÄ src/App.tsx
  ‚îÇ           ‚îú‚îÄ‚îÄ package.json
  ‚îÇ           ‚îî‚îÄ‚îÄ ...  # –í—Å–µ —Ñ–∞–π–ª—ã –≤–µ—Ä—Å–∏–∏
```

### üîÑ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

#### **–õ–æ–∫–∞–ª—å–Ω—ã–π –∞–≥–µ–Ω—Ç (shipvibes-dev.js)**
```javascript
// 1. –ü–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ WebSocket —Å–µ—Ä–≤–µ—Ä—É
// 2. –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç—Å—è —Å PROJECT_ID
// 3. –ó–∞–ø—É—Å–∫–∞–µ—Ç file watcher (chokidar)
// 4. –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ñ–∞–π–ª–∞:
//    - –ß–∏—Ç–∞–µ—Ç —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ
//    - –í—ã—á–∏—Å–ª—è–µ—Ç hash
//    - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —á–µ—Ä–µ–∑ WebSocket
```

#### **WebSocket —Å–µ—Ä–≤–µ—Ä**
```javascript
// 1. –ü–æ–ª—É—á–∞–µ—Ç file_change —Å–æ–±—ã—Ç–∏—è
// 2. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ pending_changes
// 3. –£–≤–µ–¥–æ–º–ª—è–µ—Ç –¥—Ä—É–≥–∏—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤
// 4. –ü—Ä–∏ –¥–µ–ø–ª–æ–µ:
//    - –°–æ–∑–¥–∞–µ—Ç –ø–æ–ª–Ω—ã–π —Å–Ω–∞–ø—à–æ—Ç
//    - –ó–∞–ø—É—Å–∫–∞–µ—Ç Netlify –¥–µ–ø–ª–æ–π
//    - –û—á–∏—â–∞–µ—Ç pending_changes
```

### üöÄ –ü—Ä–æ—Ü–µ—Å—Å –¥–µ–ø–ª–æ—è

1. **–°–±–æ—Ä —Ñ–∞–π–ª–æ–≤**: –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤ –∏–∑ pending_changes + –ø–æ—Å–ª–µ–¥–Ω–∏–µ –≤–µ—Ä—Å–∏–∏ –∏–∑ file_history
2. **–°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–º–∏—Ç–∞**: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ–ª–Ω–æ–≥–æ —Å–Ω–∞–ø—à–æ—Ç–∞ –≤ R2 –∏ –ë–î
3. **–°–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞**: 
   - –°–æ–∑–¥–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
   - –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –∏–∑ R2
   - `pnpm install` + `pnpm build`
4. **–î–µ–ø–ª–æ–π –Ω–∞ Netlify**:
   - –°–æ–∑–¥–∞–Ω–∏–µ ZIP –∏–∑ –ø–∞–ø–∫–∏ `dist/`
   - –û—Ç–ø—Ä–∞–≤–∫–∞ —á–µ—Ä–µ–∑ Netlify API
   - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å—Ç–∞—Ç—É—Å–∞ –¥–µ–ø–ª–æ—è

### üõ°Ô∏è –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

#### **–î–≤—É—Ö—ç—Ç–∞–ø–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞**
- **Tracking**: –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ä–∞–∑—É –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä (pending_changes)
- **Commit**: –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —Å–Ω–∞–ø—à–æ—Ç–æ–≤ + –¥–µ–ø–ª–æ–π

#### **Real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è**
- WebSocket –¥–ª—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ —Å—Ç–∞—Ç—É—Å–µ –¥–µ–ø–ª–æ—è
- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –æ—Ç –¥—Ä—É–≥–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

#### **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å**
- Cloudflare R2 –¥–ª—è —Ñ–∞–π–ª–æ–≤ (–¥–µ—à–µ–≤–æ–µ –æ–±—ä–µ–∫—Ç–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ)
- Supabase –¥–ª—è –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö (PostgreSQL —Å –∞–≤—Ç–æ—Å–∫–µ–π–ª–∏–Ω–≥–æ–º)
- Netlify –¥–ª—è –¥–µ–ø–ª–æ—è (CDN + –∞–≤—Ç–æ—Å–±–æ—Ä–∫–∞)

–≠—Ç–æ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–∑–≤–æ–ª—è–µ—Ç –Ω–µ—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –ª–µ–≥–∫–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥ –∏ –≤–∏–¥–µ—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ –±—Ä–∞—É–∑–µ—Ä–µ, –ø—Ä–∏ —ç—Ç–æ–º –∏—Å–ø–æ–ª—å–∑—É—è –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏.
