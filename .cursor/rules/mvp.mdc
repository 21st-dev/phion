---
description: 
globs: 
alwaysApply: false
---
TODO-–ø–ª–∞–Ω –¥–ª—è MVP –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã Shipvibes.dev

–≠—Ç–æ—Ç –ø–ª–∞–Ω –æ–ø–∏—Å—ã–≤–∞–µ—Ç –º–∏–Ω–∏–º–∞–ª—å–Ω–æ –∂–∏–∑–Ω–µ—Å–ø–æ—Å–æ–±–Ω—ã–π –ø—Ä–æ–¥—É–∫—Ç (MVP) –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã Shipvibes.dev, –∫–æ—Ç–æ—Ä–∞—è –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —à–∞–±–ª–æ–Ω —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥-–ø—Ä–æ–µ–∫—Ç–∞ –∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏. –ù–∏–∂–µ –ø—Ä–∏–≤–µ–¥–µ–Ω —á–µ—Ç–∫–∏–π –ø–æ—ç—Ç–∞–ø–Ω—ã–π –ø–ª–∞–Ω —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏, –≤–∫–ª—é—á–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä—É Turborepo –º–æ–Ω–æ—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è, –∫–ª—é—á–µ–≤—ã–µ —Ñ–∞–π–ª—ã/–º–æ–¥—É–ª–∏ –∏ –∏—Ö –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ, –∞ —Ç–∞–∫–∂–µ —à–∞–≥–∏ –ø–æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Supabase –∏ Cloudflare R2.

1. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ Turborepo –º–æ–Ω–æ—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –∏ –±–∞–∑–æ–≤–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

–ü–µ—Ä–≤—ã–µ —à–∞–≥–∏ ‚Äì –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å Turborepo –º–æ–Ω–æ—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Å–µ—Ä–≤–∏—Å—ã (Supabase –¥–ª—è –ë–î, R2 –¥–ª—è —Ñ–∞–π–ª–æ–≤). –°–æ–∑–¥–∞–µ–º –æ—Å–Ω–æ–≤—É –ø—Ä–æ–µ–∫—Ç–∞ —Å —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º –Ω–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏ –ø–∞–∫–µ—Ç—ã:

```
shipvibes/
‚îú‚îÄ‚îÄ apps/
‚îÇ   ‚îú‚îÄ‚îÄ web/                          # Next.js App Router –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ app/                      # App Router —Å—Ç—Ä—É–∫—Ç—É—Ä–∞
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ page.tsx              # –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ project/[id]/page.tsx # –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø—Ä–æ–µ–∫—Ç–∞
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ api/                  # API Routes
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ projects/route.ts # CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –ø—Ä–æ–µ–∫—Ç–∞–º–∏
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ auth/             # –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ globals.css           # –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ components/               # React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ project-list.tsx      # –°–ø–∏—Å–æ–∫ –ø—Ä–æ–µ–∫—Ç–æ–≤
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ file-history.tsx      # –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π —Ñ–∞–π–ª–æ–≤
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ diff-viewer.tsx       # –ü—Ä–æ—Å–º–æ—Ç—Ä –¥–∏—Ñ—Ñ–æ–≤
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ui/                   # UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ lib/                      # –£—Ç–∏–ª–∏—Ç—ã –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ supabase.ts           # Supabase –∫–ª–∏–µ–Ω—Ç
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ utils.ts              # –û–±—â–∏–µ —É—Ç–∏–ª–∏—Ç—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ next.config.js            # Next.js –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ tailwind.config.js        # Tailwind CSS –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ package.json              # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ websocket-server/             # WebSocket —Å–µ—Ä–≤–µ—Ä
‚îÇ       ‚îú‚îÄ‚îÄ src/
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ index.ts              # –û—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–µ—Ä
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ handlers/             # –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ WebSocket —Å–æ–±—ã—Ç–∏–π
‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ file-changes.ts   # –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π —Ñ–∞–π–ª–æ–≤
‚îÇ       ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ project-sync.ts   # –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–æ–≤
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ services/             # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ diff.ts           # –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –¥–∏—Ñ—Ñ–æ–≤
‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ deploy.ts         # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Netlify
‚îÇ       ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ storage.ts        # –†–∞–±–æ—Ç–∞ —Å R2
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ types/                # TypeScript —Ç–∏–ø—ã
‚îÇ       ‚îú‚îÄ‚îÄ package.json              # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ WebSocket —Å–µ—Ä–≤–µ—Ä–∞
‚îÇ       ‚îî‚îÄ‚îÄ tsconfig.json             # TypeScript –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ
‚îú‚îÄ‚îÄ packages/
‚îÇ   ‚îú‚îÄ‚îÄ shared/                       # –û–±—â–∏–µ —Ç–∏–ø—ã –∏ —É—Ç–∏–ª–∏—Ç—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ types/                # –û–±—â–∏–µ TypeScript —Ç–∏–ø—ã
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ project.ts        # –¢–∏–ø—ã –ø—Ä–æ–µ–∫—Ç–æ–≤
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ file-history.ts   # –¢–∏–ø—ã –∏—Å—Ç–æ—Ä–∏–∏ —Ñ–∞–π–ª–æ–≤
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ websocket.ts      # –¢–∏–ø—ã WebSocket —Å–æ–æ–±—â–µ–Ω–∏–π
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ utils/                # –û–±—â–∏–µ —É—Ç–∏–ª–∏—Ç—ã
‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ validation.ts     # –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ constants.ts      # –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ package.json              # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ shared –ø–∞–∫–µ—Ç–∞
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ tsconfig.json             # TypeScript –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ database/                     # Supabase –∫–ª–∏–µ–Ω—Ç –∏ —Å—Ö–µ–º—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ client.ts             # Supabase –∫–ª–∏–µ–Ω—Ç
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ types.ts              # –¢–∏–ø—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ migrations/           # SQL –º–∏–≥—Ä–∞—Ü–∏–∏
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ 001_initial.sql   # –ù–∞—á–∞–ª—å–Ω–∞—è —Å—Ö–µ–º–∞
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ 002_file_history.sql # –¢–∞–±–ª–∏—Ü–∞ –∏—Å—Ç–æ—Ä–∏–∏ —Ñ–∞–π–ª–æ–≤
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ queries/              # –ì–æ—Ç–æ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã
‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ projects.ts       # –ó–∞–ø—Ä–æ—Å—ã –¥–ª—è –ø—Ä–æ–µ–∫—Ç–æ–≤
‚îÇ   ‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ file-history.ts   # –ó–∞–ø—Ä–æ—Å—ã –¥–ª—è –∏—Å—Ç–æ—Ä–∏–∏ —Ñ–∞–π–ª–æ–≤
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ package.json              # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ database –ø–∞–∫–µ—Ç–∞
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ tsconfig.json             # TypeScript –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ storage/                      # Cloudflare R2 –∫–ª–∏–µ–Ω—Ç
‚îÇ       ‚îú‚îÄ‚îÄ src/
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ client.ts             # R2 –∫–ª–∏–µ–Ω—Ç
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ types.ts              # –¢–∏–ø—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ñ–∞–π–ª–∞–º–∏
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ operations/           # –û–ø–µ—Ä–∞—Ü–∏–∏ —Å —Ñ–∞–π–ª–∞–º–∏
‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ upload.ts         # –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤
‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ download.ts       # –°–∫–∞—á–∏–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤
‚îÇ       ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ versioning.ts     # –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ utils/                # –£—Ç–∏–ª–∏—Ç—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å R2
‚îÇ       ‚îÇ       ‚îú‚îÄ‚îÄ paths.ts          # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—É—Ç–µ–π —Ñ–∞–π–ª–æ–≤
‚îÇ       ‚îÇ       ‚îî‚îÄ‚îÄ compression.ts    # –°–∂–∞—Ç–∏–µ –∞—Ä—Ö–∏–≤–æ–≤
‚îÇ       ‚îú‚îÄ‚îÄ package.json              # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ storage –ø–∞–∫–µ—Ç–∞
‚îÇ       ‚îî‚îÄ‚îÄ tsconfig.json             # TypeScript –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ
‚îú‚îÄ‚îÄ templates/                        # –®–∞–±–ª–æ–Ω—ã –ø—Ä–æ–µ–∫—Ç–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ vite-react/                   # –ë–∞–∑–æ–≤—ã–π Vite + React —à–∞–±–ª–æ–Ω
‚îÇ       ‚îú‚îÄ‚îÄ package.json              # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —à–∞–±–ª–æ–Ω–∞
‚îÇ       ‚îú‚îÄ‚îÄ vite.config.js            # Vite –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ       ‚îú‚îÄ‚îÄ index.html                # HTML —à–∞–±–ª–æ–Ω
‚îÇ       ‚îú‚îÄ‚îÄ src/
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ main.jsx              # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ React
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ App.jsx               # –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ index.css             # –°—Ç–∏–ª–∏
‚îÇ       ‚îú‚îÄ‚îÄ shipvibes-dev.js          # –õ–æ–∫–∞–ª—å–Ω—ã–π –∞–≥–µ–Ω—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
‚îÇ       ‚îî‚îÄ‚îÄ README.md                 # –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
‚îÇ
‚îú‚îÄ‚îÄ turbo.json                        # Turborepo –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ package.json                      # –ö–æ—Ä–Ω–µ–≤—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ pnpm-workspace.yaml               # PNPM workspace –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îî‚îÄ‚îÄ README.md                         # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞
```

–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è:
- Supabase –ø—Ä–æ–µ–∫—Ç —Å PostgreSQL –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
- Cloudflare R2 bucket –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤
- –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤

2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö Supabase (—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü)

–°–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—ã –≤ Supabase –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤ –∏ –∏—Å—Ç–æ—Ä–∏–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π:

```sql
-- packages/database/src/migrations/001_initial.sql
-- –¢–∞–±–ª–∏—Ü–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Supabase Auth)
-- auth.users —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç

-- –¢–∞–±–ª–∏—Ü–∞ –ø—Ä–æ–µ–∫—Ç–æ–≤
CREATE TABLE projects (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID REFERENCES auth.users(id) ON DELETE CASCADE,
  name TEXT NOT NULL DEFAULT 'Untitled Project',
  template_type TEXT NOT NULL DEFAULT 'vite-react',
  netlify_site_id TEXT,
  netlify_url TEXT,
  deploy_status TEXT DEFAULT 'pending',
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- –¢–∞–±–ª–∏—Ü–∞ –∏—Å—Ç–æ—Ä–∏–∏ —Ñ–∞–π–ª–æ–≤
CREATE TABLE file_history (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  project_id UUID REFERENCES projects(id) ON DELETE CASCADE,
  file_path TEXT NOT NULL,
  r2_object_key TEXT NOT NULL, -- –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É –≤ R2
  content_hash TEXT, -- SHA-256 —Ö–µ—à —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –¥–ª—è –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏–∏
  diff_text TEXT, -- –ü—Ä–µ–¥–≤—ã—á–∏—Å–ª–µ–Ω–Ω—ã–π diff
  file_size INTEGER,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- –ò–Ω–¥–µ–∫—Å—ã –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤
CREATE INDEX idx_projects_user_id ON projects(user_id);
CREATE INDEX idx_file_history_project_id ON file_history(project_id);
CREATE INDEX idx_file_history_created_at ON file_history(created_at);
CREATE INDEX idx_file_history_file_path ON file_history(project_id, file_path, created_at);

-- Row Level Security (RLS)
ALTER TABLE projects ENABLE ROW LEVEL SECURITY;
ALTER TABLE file_history ENABLE ROW LEVEL SECURITY;

-- –ü–æ–ª–∏—Ç–∏–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
CREATE POLICY "Users can view own projects" ON projects
  FOR SELECT USING (auth.uid() = user_id);

CREATE POLICY "Users can create own projects" ON projects
  FOR INSERT WITH CHECK (auth.uid() = user_id);

CREATE POLICY "Users can update own projects" ON projects
  FOR UPDATE USING (auth.uid() = user_id);

CREATE POLICY "Users can view file history of own projects" ON file_history
  FOR SELECT USING (
    EXISTS (
      SELECT 1 FROM projects 
      WHERE projects.id = file_history.project_id 
      AND projects.user_id = auth.uid()
    )
  );

CREATE POLICY "System can insert file history" ON file_history
  FOR INSERT WITH CHECK (true); -- WebSocket —Å–µ—Ä–≤–µ—Ä –∏—Å–ø–æ–ª—å–∑—É–µ—Ç service key
```

–û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è —Ñ–∞–π–ª–æ–≤ –≤ R2:
```
projects/
‚îú‚îÄ‚îÄ {project_id}/
‚îÇ   ‚îú‚îÄ‚îÄ template.zip              # –ò—Å—Ö–æ–¥–Ω—ã–π —à–∞–±–ª–æ–Ω –ø—Ä–æ–µ–∫—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ versions/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ {version_id}/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ {file_path}       # –í–µ—Ä—Å–∏–∏ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ metadata.json     # –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –≤–µ—Ä—Å–∏–∏
‚îÇ   ‚îî‚îÄ‚îÄ builds/
‚îÇ       ‚îî‚îÄ‚îÄ {build_id}/
‚îÇ           ‚îî‚îÄ‚îÄ dist.zip          # –°–æ–±—Ä–∞–Ω–Ω—ã–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã –¥–ª—è –¥–µ–ø–ª–æ—è
```

3. –§—Ä–æ–Ω—Ç–µ–Ω–¥: Next.js App Router –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Next.js App Router:

```typescript
// apps/web/app/page.tsx - –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
import { CreateProjectButton } from '@/components/create-project-button'
import { ProjectList } from '@/components/project-list'
import { createServerComponentClient } from '@supabase/auth-helpers-nextjs'
import { cookies } from 'next/headers'

export default async function HomePage() {
  const supabase = createServerComponentClient({ cookies })
  const { data: { session } } = await supabase.auth.getSession()

  if (!session) {
    return <AuthForm />
  }

  const { data: projects } = await supabase
    .from('projects')
    .select('*')
    .order('created_at', { ascending: false })

  return (
    <div className="container mx-auto px-4 py-8">
      <div className="flex justify-between items-center mb-8">
        <h1 className="text-3xl font-bold">–ú–æ–∏ –ø—Ä–æ–µ–∫—Ç—ã</h1>
        <CreateProjectButton />
      </div>
      <ProjectList projects={projects || []} />
    </div>
  )
}
```

```typescript
// apps/web/app/api/projects/route.ts - API –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–æ–≤
import { createRouteHandlerClient } from '@supabase/auth-helpers-nextjs'
import { cookies } from 'next/headers'
import { NextRequest, NextResponse } from 'next/server'
import { generateProjectTemplate } from '@shipvibes/storage'

export async function POST(request: NextRequest) {
  const supabase = createRouteHandlerClient({ cookies })
  const { data: { session } } = await supabase.auth.getSession()

  if (!session) {
    return NextResponse.json({ error: 'Unauthorized' }, { status: 401 })
  }

  try {
    // –°–æ–∑–¥–∞–µ–º –ø—Ä–æ–µ–∫—Ç –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
    const { data: project, error } = await supabase
      .from('projects')
      .insert({
        user_id: session.user.id,
        name: `Project ${Date.now()}`,
        template_type: 'vite-react'
      })
      .select()
      .single()

    if (error) throw error

    // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —à–∞–±–ª–æ–Ω –ø—Ä–æ–µ–∫—Ç–∞ –∏ –∑–∞–≥—Ä—É–∂–∞–µ–º –≤ R2
    const templateZip = await generateProjectTemplate(project.id, 'vite-react')
    
    // –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Å—Å—ã–ª–∫—É –Ω–∞ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ
    return NextResponse.json({
      project,
      downloadUrl: `/api/projects/${project.id}/download`
    })
  } catch (error) {
    return NextResponse.json(
      { error: 'Failed to create project' },
      { status: 500 }
    )
  }
}
```

```typescript
// apps/web/app/project/[id]/page.tsx - –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø—Ä–æ–µ–∫—Ç–∞
import { FileHistory } from '@/components/file-history'
import { ProjectHeader } from '@/components/project-header'
import { createServerComponentClient } from '@supabase/auth-helpers-nextjs'
import { cookies } from 'next/headers'
import { notFound } from 'next/navigation'

interface ProjectPageProps {
  params: { id: string }
}

export default async function ProjectPage({ params }: ProjectPageProps) {
  const supabase = createServerComponentClient({ cookies })
  
  const { data: project } = await supabase
    .from('projects')
    .select('*')
    .eq('id', params.id)
    .single()

  if (!project) {
    notFound()
  }

  const { data: fileHistory } = await supabase
    .from('file_history')
    .select('*')
    .eq('project_id', params.id)
    .order('created_at', { ascending: false })

  return (
    <div className="container mx-auto px-4 py-8">
      <ProjectHeader project={project} />
      <FileHistory history={fileHistory || []} />
    </div>
  )
}
```

4. –®–∞–±–ª–æ–Ω –ø—Ä–æ–µ–∫—Ç–∞ —Å –ª–æ–∫–∞–ª—å–Ω—ã–º –∞–≥–µ–Ω—Ç–æ–º

–ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —à–∞–±–ª–æ–Ω Vite + React —Å –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –∞–≥–µ–Ω—Ç–æ–º —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏:

```javascript
// templates/vite-react/shipvibes-dev.js
#!/usr/bin/env node

const fs = require('fs')
const path = require('path')
const { spawn } = require('child_process')
const chokidar = require('chokidar')
const { io } = require('socket.io-client')
const crypto = require('crypto')

const PROJECT_ID = '__PROJECT_ID__' // –ó–∞–º–µ–Ω—è–µ—Ç—Å—è –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
const WS_URL = process.env.SHIPVIBES_WS_URL || 'wss://api.shipvibes.dev'

class ShipvibesAgent {
  constructor() {
    this.socket = null
    this.devServer = null
    this.watcher = null
  }

  async start() {
    console.log('üöÄ –ó–∞–ø—É—Å–∫ Shipvibes Agent...')
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –æ–∫—Ä—É–∂–µ–Ω–∏–µ
    await this.checkEnvironment()
    
    // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
    await this.installDependencies()
    
    // –ó–∞–ø—É—Å–∫–∞–µ–º dev —Å–µ—Ä–≤–µ—Ä
    this.startDevServer()
    
    // –ü–æ–¥–∫–ª—é—á–∞–µ–º—Å—è –∫ WebSocket
    this.connectWebSocket()
    
    // –ó–∞–ø—É—Å–∫–∞–µ–º file watcher
    this.startFileWatcher()
    
    console.log(`üì± –û—Ç–∫—Ä–æ–π—Ç–µ https://shipvibes.dev/project/${PROJECT_ID} –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π`)
  }

  async checkEnvironment() {
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º Node.js
    if (!process.version) {
      throw new Error('Node.js –Ω–µ –Ω–∞–π–¥–µ–Ω')
    }
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º pnpm
    try {
      await this.execCommand('pnpm', ['--version'])
    } catch (error) {
      console.log('üì¶ –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º pnpm...')
      await this.execCommand('npm', ['install', '-g', 'pnpm'])
    }
  }

  async installDependencies() {
    console.log('üì¶ –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏...')
    await this.execCommand('pnpm', ['install'])
  }

  startDevServer() {
    console.log('üî• –ó–∞–ø—É—Å–∫–∞–µ–º dev —Å–µ—Ä–≤–µ—Ä...')
    this.devServer = spawn('pnpm', ['run', 'dev'], {
      stdio: ['inherit', 'pipe', 'pipe']
    })
    
    this.devServer.stdout.on('data', (data) => {
      const output = data.toString()
      if (output.includes('Local:')) {
        console.log('‚úÖ Dev —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω:', output.match(/http:\/\/localhost:\d+/)?.[0])
      }
    })
  }

  connectWebSocket() {
    console.log('üîå –ü–æ–¥–∫–ª—é—á–∞–µ–º—Å—è –∫ Shipvibes...')
    
    this.socket = io(WS_URL, {
      auth: {
        projectId: PROJECT_ID
      }
    })

    this.socket.on('connect', () => {
      console.log('‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–æ –∫ Shipvibes')
    })

    this.socket.on('disconnect', () => {
      console.log('‚ùå –û—Ç–∫–ª—é—á–µ–Ω–æ –æ—Ç Shipvibes')
    })

    this.socket.on('file_saved', (data) => {
      console.log(`üíæ –§–∞–π–ª —Å–æ—Ö—Ä–∞–Ω–µ–Ω: ${data.file_path}`)
    })
  }

  startFileWatcher() {
    console.log('üëÄ –û—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤...')
    
    this.watcher = chokidar.watch('.', {
      ignored: [
        'node_modules/**',
        '.git/**',
        'dist/**',
        '.shipvibes/**',
        'shipvibes-dev.js'
      ],
      ignoreInitial: true
    })

    this.watcher.on('change', (filePath) => {
      this.handleFileChange(filePath)
    })

    this.watcher.on('add', (filePath) => {
      this.handleFileChange(filePath)
    })

    this.watcher.on('unlink', (filePath) => {
      this.handleFileDelete(filePath)
    })
  }

  async handleFileChange(filePath) {
    try {
      const content = fs.readFileSync(filePath, 'utf-8')
      const hash = crypto.createHash('sha256').update(content).digest('hex')
      
      console.log(`üìù –ò–∑–º–µ–Ω–µ–Ω: ${filePath}`)
      
      this.socket?.emit('file_change', {
        projectId: PROJECT_ID,
        filePath: filePath.replace(/\\/g, '/'), // –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º –ø—É—Ç—å
        content,
        hash,
        timestamp: Date.now()
      })
    } catch (error) {
      console.error(`‚ùå –û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è —Ñ–∞–π–ª–∞ ${filePath}:`, error.message)
    }
  }

  handleFileDelete(filePath) {
    console.log(`üóëÔ∏è –£–¥–∞–ª–µ–Ω: ${filePath}`)
    
    this.socket?.emit('file_delete', {
      projectId: PROJECT_ID,
      filePath: filePath.replace(/\\/g, '/'),
      timestamp: Date.now()
    })
  }

  async execCommand(command, args) {
    return new Promise((resolve, reject) => {
      const process = spawn(command, args, { stdio: 'inherit' })
      process.on('close', (code) => {
        if (code === 0) {
          resolve()
        } else {
          reject(new Error(`Command failed with code ${code}`))
        }
      })
    })
  }

  stop() {
    console.log('üõë –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º Shipvibes Agent...')
    
    this.watcher?.close()
    this.socket?.disconnect()
    this.devServer?.kill()
  }
}

// –ó–∞–ø—É—Å–∫ –∞–≥–µ–Ω—Ç–∞
const agent = new ShipvibesAgent()

process.on('SIGINT', () => {
  agent.stop()
  process.exit(0)
})

process.on('SIGTERM', () => {
  agent.stop()
  process.exit(0)
})

agent.start().catch((error) => {
  console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–ø—É—Å–∫–∞:', error.message)
  process.exit(1)
})
```

5. WebSocket —Å–µ—Ä–≤–µ—Ä –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π

–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å WebSocket —Å–µ—Ä–≤–µ—Ä –¥–ª—è –ø—Ä–∏–µ–º–∞ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π —Ñ–∞–π–ª–æ–≤:

```typescript
// apps/websocket-server/src/index.ts
import { Server } from 'socket.io'
import { createServer } from 'http'
import { handleFileChange, handleFileDelete } from './handlers/file-changes'
import { authenticateSocket } from './middleware/auth'

const server = createServer()
const io = new Server(server, {
  cors: {
    origin: process.env.ALLOWED_ORIGINS?.split(',') || ['http://localhost:3000'],
    methods: ['GET', 'POST']
  }
})

io.use(authenticateSocket)

io.on('connection', (socket) => {
  console.log(`Client connected: ${socket.id}`)
  
  const projectId = socket.handshake.auth.projectId
  socket.join(`project:${projectId}`)

  socket.on('file_change', async (data) => {
    try {
      await handleFileChange(data, socket)
    } catch (error) {
      console.error('Error handling file change:', error)
      socket.emit('error', { message: 'Failed to save file' })
    }
  })

  socket.on('file_delete', async (data) => {
    try {
      await handleFileDelete(data, socket)
    } catch (error) {
      console.error('Error handling file delete:', error)
      socket.emit('error', { message: 'Failed to delete file' })
    }
  })

  socket.on('disconnect', () => {
    console.log(`Client disconnected: ${socket.id}`)
  })
})

const PORT = process.env.PORT || 8080
server.listen(PORT, () => {
  console.log(`WebSocket server running on port ${PORT}`)
})
```

```typescript
// apps/websocket-server/src/handlers/file-changes.ts
import { Socket } from 'socket.io'
import { supabase } from '@shipvibes/database'
import { uploadFileVersion, generateDiff } from '@shipvibes/storage'
import { triggerDeploy } from '../services/deploy'

export async function handleFileChange(data: any, socket: Socket) {
  const { projectId, filePath, content, hash } = data

  // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∏–∑–º–µ–Ω–∏–ª—Å—è –ª–∏ —Ñ–∞–π–ª (–ø–æ —Ö–µ—à—É)
  const { data: lastVersion } = await supabase
    .from('file_history')
    .select('content_hash')
    .eq('project_id', projectId)
    .eq('file_path', filePath)
    .order('created_at', { ascending: false })
    .limit(1)
    .single()

  if (lastVersion?.content_hash === hash) {
    // –§–∞–π–ª –Ω–µ –∏–∑–º–µ–Ω–∏–ª—Å—è, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º
    return
  }

  // –ó–∞–≥—Ä—É–∂–∞–µ–º —Ñ–∞–π–ª –≤ R2
  const versionId = crypto.randomUUID()
  const r2ObjectKey = `projects/${projectId}/versions/${versionId}/${filePath}`
  
  await uploadFileVersion(r2ObjectKey, content)

  // –í—ã—á–∏—Å–ª—è–µ–º diff —Å –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤–µ—Ä—Å–∏–µ–π
  let diffText = null
  if (lastVersion) {
    const previousContent = await downloadFileVersion(lastVersion.r2_object_key)
    diffText = generateDiff(previousContent, content)
  }

  // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∑–∞–ø–∏—Å—å –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
  const { error } = await supabase
    .from('file_history')
    .insert({
      project_id: projectId,
      file_path: filePath,
      r2_object_key: r2ObjectKey,
      content_hash: hash,
      diff_text: diffText,
      file_size: Buffer.byteLength(content, 'utf-8')
    })

  if (error) {
    throw error
  }

  // –£–≤–µ–¥–æ–º–ª—è–µ–º –∫–ª–∏–µ–Ω—Ç–∞ –æ–± —É—Å–ø–µ—à–Ω–æ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏
  socket.emit('file_saved', {
    filePath,
    versionId,
    timestamp: Date.now()
  })

  // –£–≤–µ–¥–æ–º–ª—è–µ–º –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —á–µ—Ä–µ–∑ Supabase Realtime
  // (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Ç–∞–±–ª–∏—Ü–µ)

  // –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: –∑–∞–ø—É—Å–∫–∞–µ–º –¥–µ–ø–ª–æ–π
  await triggerDeploy(projectId)
}
```

6. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Netlify –¥–ª—è –∞–≤—Ç–æ–¥–µ–ø–ª–æ—è

```typescript
// apps/websocket-server/src/services/deploy.ts
import { NetlifyAPI } from 'netlify'
import { supabase } from '@shipvibes/database'
import { downloadProjectFiles, buildProject } from '@shipvibes/storage'

const netlify = new NetlifyAPI(process.env.NETLIFY_ACCESS_TOKEN)

export async function triggerDeploy(projectId: string) {
  try {
    // –ü–æ–ª—É—á–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø—Ä–æ–µ–∫—Ç–µ
    const { data: project } = await supabase
      .from('projects')
      .select('*')
      .eq('id', projectId)
      .single()

    if (!project) {
      throw new Error('Project not found')
    }

    // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å –¥–µ–ø–ª–æ—è
    await supabase
      .from('projects')
      .update({ deploy_status: 'building' })
      .eq('id', projectId)

    // –°–∫–∞—á–∏–≤–∞–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–µ —Ñ–∞–π–ª—ã –ø—Ä–æ–µ–∫—Ç–∞ –∏–∑ R2
    const projectFiles = await downloadProjectFiles(projectId)
    
    // –°–æ–±–∏—Ä–∞–µ–º –ø—Ä–æ–µ–∫—Ç
    const buildArtifacts = await buildProject(projectFiles)
    
    // –°–æ–∑–¥–∞–µ–º —Å–∞–π—Ç –Ω–∞ Netlify (–µ—Å–ª–∏ –µ—â–µ –Ω–µ —Å–æ–∑–¥–∞–Ω)
    if (!project.netlify_site_id) {
      const site = await netlify.createSite({
        body: {
          name: `shipvibes-${projectId.slice(0, 8)}`
        }
      })
      
      await supabase
        .from('projects')
        .update({ 
          netlify_site_id: site.id,
          netlify_url: site.url
        })
        .eq('id', projectId)
        
      project.netlify_site_id = site.id
      project.netlify_url = site.url
    }

    // –î–µ–ø–ª–æ–∏–º –Ω–∞ Netlify
    const deploy = await netlify.createSiteDeploy({
      siteId: project.netlify_site_id,
      body: {
        files: buildArtifacts
      }
    })

    // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å –¥–µ–ø–ª–æ—è
    await supabase
      .from('projects')
      .update({ 
        deploy_status: deploy.state,
        netlify_url: deploy.deploy_ssl_url || project.netlify_url
      })
      .eq('id', projectId)

    console.log(`Deploy triggered for project ${projectId}: ${deploy.deploy_ssl_url}`)
  } catch (error) {
    console.error(`Deploy failed for project ${projectId}:`, error)
    
    await supabase
      .from('projects')
      .update({ deploy_status: 'failed' })
      .eq('id', projectId)
  }
}
```

7. –ü–∞–∫–µ—Ç—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å R2 –∏ Supabase

```typescript
// packages/storage/src/client.ts
import { S3Client, PutObjectCommand, GetObjectCommand } from '@aws-sdk/client-s3'

const r2Client = new S3Client({
  region: 'auto',
  endpoint: process.env.R2_ENDPOINT,
  credentials: {
    accessKeyId: process.env.R2_ACCESS_KEY_ID!,
    secretAccessKey: process.env.R2_SECRET_ACCESS_KEY!
  }
})

export async function uploadFileVersion(key: string, content: string): Promise<void> {
  await r2Client.send(new PutObjectCommand({
    Bucket: process.env.R2_BUCKET_NAME,
    Key: key,
    Body: content,
    ContentType: 'text/plain'
  }))
}

export async function downloadFileVersion(key: string): Promise<string> {
  const response = await r2Client.send(new GetObjectCommand({
    Bucket: process.env.R2_BUCKET_NAME,
    Key: key
  }))
  
  return await response.Body?.transformToString() || ''
}
```

```typescript
// packages/database/src/client.ts
import { createClient } from '@supabase/supabase-js'

export const supabase = createClient(
  process.env.SUPABASE_URL!,
  process.env.SUPABASE_SERVICE_ROLE_KEY!, // –î–ª—è —Å–µ—Ä–≤–µ—Ä–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
  {
    auth: {
      autoRefreshToken: false,
      persistSession: false
    }
  }
)
```

8. –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–∞—è –≤–µ—Ä—Å–∏—è (–ø–µ—Ä–≤—ã–π commit)

–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ –∫–æ–º–º–∏—Ç–∞:

```
shipvibes/
‚îú‚îÄ‚îÄ apps/
‚îÇ   ‚îú‚îÄ‚îÄ web/                     # ‚úÖ Next.js App Router –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îÇ   ‚îî‚îÄ‚îÄ websocket-server/        # ‚úÖ WebSocket —Å–µ—Ä–≤–µ—Ä
‚îú‚îÄ‚îÄ packages/
‚îÇ   ‚îú‚îÄ‚îÄ shared/                  # ‚úÖ –û–±—â–∏–µ —Ç–∏–ø—ã
‚îÇ   ‚îú‚îÄ‚îÄ database/                # ‚úÖ Supabase –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ storage/                 # ‚úÖ R2 –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ templates/
‚îÇ   ‚îî‚îÄ‚îÄ vite-react/              # ‚úÖ –®–∞–±–ª–æ–Ω —Å –∞–≥–µ–Ω—Ç–æ–º
‚îú‚îÄ‚îÄ turbo.json                   # ‚úÖ Turborepo –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îî‚îÄ‚îÄ package.json                 # ‚úÖ –ö–æ—Ä–Ω–µ–≤—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```

–¢–µ—Å—Ç–æ–≤—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π:
1. –ó–∞–ø—É—Å—Ç–∏—Ç—å `pnpm dev` –≤ –∫–æ—Ä–Ω–µ (–∑–∞–ø—É—Å–∫–∞–µ—Ç –≤—Å–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è)
2. –û—Ç–∫—Ä—ã—Ç—å –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å, –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è —á–µ—Ä–µ–∑ Supabase Auth
3. –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç - –¥–æ–ª–∂–µ–Ω —Å–∫–∞—á–∞—Ç—å—Å—è –∞—Ä—Ö–∏–≤
4. –†–∞—Å–ø–∞–∫–æ–≤–∞—Ç—å –∞—Ä—Ö–∏–≤, –∑–∞–ø—É—Å—Ç–∏—Ç—å `node shipvibes-dev.js`
5. –ò–∑–º–µ–Ω–∏—Ç—å —Ñ–∞–π–ª –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ - –∏–∑–º–µ–Ω–µ–Ω–∏—è –¥–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è –≤ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ
6. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–µ–ø–ª–æ–π –Ω–∞ Netlify

–ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–≥–æ MVP:
- **Turborepo** –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –º–æ–Ω–æ—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–º
- **Next.js App Router** –¥–ª—è —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
- **Supabase** –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- **Cloudflare R2** –¥–ª—è –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤
- **TypeScript** –≤–æ –≤—Å–µ—Ö –ø–∞–∫–µ—Ç–∞—Ö –¥–ª—è —Ç–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- **Realtime –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è** —á–µ—Ä–µ–∑ Supabase Realtime
- **–ú–æ–¥—É–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** —Å –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–º–∏ –ø–∞–∫–µ—Ç–∞–º–∏

–≠—Ç–æ—Ç –ø–ª–∞–Ω –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –±—ã—Å—Ç—Ä—É—é —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É MVP —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π.
