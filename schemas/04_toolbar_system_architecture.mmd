sequenceDiagram
    participant USER as üë§ User
    participant BROWSER as üåê Browser
    participant TOOLBAR as üõ†Ô∏è Toolbar UI
    participant UPDATER as üîÑ Update Manager
    participant VITE_PLUGIN as ‚ö° Vite Plugin
    participant WS_CLIENT as üîÑ WS Client
    participant WS_SERVER as üîÑ WebSocket Server
    participant R2 as ‚òÅÔ∏è R2 Storage
    participant ADMIN as üë®‚Äçüíº Admin Interface

    Note over USER,ADMIN: üõ†Ô∏è TOOLBAR SYSTEM - –î–ï–¢–ê–õ–¨–ù–ê–Ø –ê–†–•–ò–¢–ï–ö–¢–£–†–ê

    %% === –°–¢–†–£–ö–¢–£–†–ê TOOLBAR –°–ò–°–¢–ï–ú–´ ===
    rect rgb(245, 245, 255)
        Note over TOOLBAR: üìÅ –°–¢–†–£–ö–¢–£–†–ê TOOLBAR –°–ò–°–¢–ï–ú–´
        
        Note left of TOOLBAR: packages/vite-plugin-vybcel/
        Note left of TOOLBAR: ‚îú‚îÄ‚îÄ src/
        Note left of TOOLBAR: ‚îÇ   ‚îú‚îÄ‚îÄ index.ts (plugin entry)
        Note left of TOOLBAR: ‚îÇ   ‚îú‚îÄ‚îÄ plugin.ts (vite plugin)
        Note left of TOOLBAR: ‚îÇ   ‚îú‚îÄ‚îÄ toolbar/
        Note left of TOOLBAR: ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ToolbarContainer.tsx
        Note left of TOOLBAR: ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ StatusIndicator.tsx
        Note left of TOOLBAR: ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ActionButtons.tsx
        Note left of TOOLBAR: ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ NotificationToast.tsx
        Note left of TOOLBAR: ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ProgressBar.tsx
        Note left of TOOLBAR: ‚îÇ   ‚îú‚îÄ‚îÄ core/
        Note left of TOOLBAR: ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ UpdateManager.ts
        Note left of TOOLBAR: ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ WebSocketClient.ts
        Note left of TOOLBAR: ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ StateManager.ts
        Note left of TOOLBAR: ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ HotReloader.ts
        Note left of TOOLBAR: ‚îÇ   ‚îú‚îÄ‚îÄ utils/
        Note left of TOOLBAR: ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ checksum.ts
        Note left of TOOLBAR: ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ download.ts
        Note left of TOOLBAR: ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ logger.ts
        Note left of TOOLBAR: ‚îÇ   ‚îî‚îÄ‚îÄ types/
        Note left of TOOLBAR: ‚îÇ       ‚îú‚îÄ‚îÄ toolbar.ts
        Note left of TOOLBAR: ‚îÇ       ‚îî‚îÄ‚îÄ update.ts
        Note left of TOOLBAR: ‚îî‚îÄ‚îÄ package.json

        Note right of TOOLBAR: –ö–û–ú–ü–û–ù–ï–ù–¢–´ –ò –ó–ê–í–ò–°–ò–ú–û–°–¢–ò
        Note right of TOOLBAR: ‚îú‚îÄ‚îÄ React 18 (UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã)
        Note right of TOOLBAR: ‚îú‚îÄ‚îÄ Tailwind CSS (—Å—Ç–∏–ª–∏–∑–∞—Ü–∏—è)
        Note right of TOOLBAR: ‚îú‚îÄ‚îÄ Framer Motion (–∞–Ω–∏–º–∞—Ü–∏–∏)
        Note right of TOOLBAR: ‚îú‚îÄ‚îÄ Socket.IO Client (WebSocket)
        Note right of TOOLBAR: ‚îú‚îÄ‚îÄ Vite Plugin API (–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è)
        Note right of TOOLBAR: ‚îú‚îÄ‚îÄ Crypto-js (checksum validation)
        Note right of TOOLBAR: ‚îî‚îÄ‚îÄ LocalStorage API (–Ω–∞—Å—Ç—Ä–æ–π–∫–∏)
    end

    %% === VITE PLUGIN –ò–ù–¢–ï–ì–†–ê–¶–ò–Ø ===
    rect rgb(240, 248, 255)
        Note over VITE_PLUGIN: ‚ö° VITE PLUGIN –ò–ù–¢–ï–ì–†–ê–¶–ò–Ø
        
        Note left of VITE_PLUGIN: PLUGIN –•–£–ö–ò –ò –ú–ï–¢–û–î–´
        Note left of VITE_PLUGIN: ‚îú‚îÄ‚îÄ configResolved() - –ø–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥–∞
        Note left of VITE_PLUGIN: ‚îú‚îÄ‚îÄ configureServer() - dev server setup
        Note left of VITE_PLUGIN: ‚îú‚îÄ‚îÄ transformIndexHtml() - HTML injection
        Note left of VITE_PLUGIN: ‚îú‚îÄ‚îÄ generateBundle() - build-time injection
        Note left of VITE_PLUGIN: ‚îî‚îÄ‚îÄ closeBundle() - cleanup

        Note right of VITE_PLUGIN: –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–û–ï –í–ù–ï–î–†–ï–ù–ò–ï
        Note right of VITE_PLUGIN: ‚îú‚îÄ‚îÄ –ß—Ç–µ–Ω–∏–µ vybcel.config.json
        Note right of VITE_PLUGIN: ‚îú‚îÄ‚îÄ Injection toolbar script –≤ HTML
        Note right of VITE_PLUGIN: ‚îú‚îÄ‚îÄ HMR –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –¥–ª—è hot updates
        Note right of VITE_PLUGIN: ‚îú‚îÄ‚îÄ CSS injection –¥–ª—è —Å—Ç–∏–ª–µ–π
        Note right of VITE_PLUGIN: ‚îî‚îÄ‚îÄ Environment variables injection

        alt –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è plugin
            VITE_PLUGIN->>VITE_PLUGIN: configResolved() hook
            VITE_PLUGIN->>VITE_PLUGIN: –ß—Ç–µ–Ω–∏–µ vybcel.config.json
            VITE_PLUGIN->>VITE_PLUGIN: –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ PROJECT_ID
            VITE_PLUGIN->>VITE_PLUGIN: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ toolbar options
        end
        
        alt HTML injection
            VITE_PLUGIN->>VITE_PLUGIN: transformIndexHtml() hook
            VITE_PLUGIN->>VITE_PLUGIN: –°–æ–∑–¥–∞–Ω–∏–µ toolbar script tag
            VITE_PLUGIN->>VITE_PLUGIN: Injection –≤ <head> –∏–ª–∏ <body>
            VITE_PLUGIN->>BROWSER: HTML —Å –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–º toolbar
        end
        
        alt Hot Module Replacement
            VITE_PLUGIN->>VITE_PLUGIN: HMR update event
            VITE_PLUGIN->>TOOLBAR: –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ toolbar –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
            VITE_PLUGIN->>BROWSER: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–µ–∑ full reload
        end
    end

    %% === TOOLBAR UI –ö–û–ú–ü–û–ù–ï–ù–¢–´ ===
    rect rgb(255, 250, 245)
        Note over TOOLBAR: üé® TOOLBAR UI –ö–û–ú–ü–û–ù–ï–ù–¢–´
        
        Note left of TOOLBAR: –û–°–ù–û–í–ù–´–ï –ö–û–ú–ü–û–ù–ï–ù–¢–´
        Note left of TOOLBAR: ‚îú‚îÄ‚îÄ ToolbarContainer
        Note left of TOOLBAR: ‚îÇ   ‚îú‚îÄ‚îÄ –ì–ª–∞–≤–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
        Note left of TOOLBAR: ‚îÇ   ‚îú‚îÄ‚îÄ –ü–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ (fixed)
        Note left of TOOLBAR: ‚îÇ   ‚îú‚îÄ‚îÄ z-index management
        Note left of TOOLBAR: ‚îÇ   ‚îî‚îÄ‚îÄ Responsive design
        Note left of TOOLBAR: ‚îú‚îÄ‚îÄ StatusIndicator
        Note left of TOOLBAR: ‚îÇ   ‚îú‚îÄ‚îÄ Connection status
        Note left of TOOLBAR: ‚îÇ   ‚îú‚îÄ‚îÄ Pending changes count
        Note left of TOOLBAR: ‚îÇ   ‚îú‚îÄ‚îÄ Deploy status
        Note left of TOOLBAR: ‚îÇ   ‚îî‚îÄ‚îÄ Loading states
        Note left of TOOLBAR: ‚îú‚îÄ‚îÄ ActionButtons
        Note left of TOOLBAR: ‚îÇ   ‚îú‚îÄ‚îÄ Save All Changes
        Note left of TOOLBAR: ‚îÇ   ‚îú‚îÄ‚îÄ Discard All Changes
        Note left of TOOLBAR: ‚îÇ   ‚îú‚îÄ‚îÄ Force Reload
        Note left of TOOLBAR: ‚îÇ   ‚îî‚îÄ‚îÄ Settings Menu
        Note left of TOOLBAR: ‚îî‚îÄ‚îÄ NotificationToast
        Note left of TOOLBAR:     ‚îú‚îÄ‚îÄ Success messages
        Note left of TOOLBAR:     ‚îú‚îÄ‚îÄ Error messages
        Note left of TOOLBAR:     ‚îú‚îÄ‚îÄ Update notifications
        Note left of TOOLBAR:     ‚îî‚îÄ‚îÄ Auto-dismiss timers

        Note right of TOOLBAR: –°–¢–ò–õ–ò –ò –ê–ù–ò–ú–ê–¶–ò–ò
        Note right of TOOLBAR: ‚îú‚îÄ‚îÄ Tailwind CSS utilities
        Note right of TOOLBAR: ‚îú‚îÄ‚îÄ Custom CSS variables
        Note right of TOOLBAR: ‚îú‚îÄ‚îÄ Framer Motion animations
        Note right of TOOLBAR: ‚îú‚îÄ‚îÄ Hover states
        Note right of TOOLBAR: ‚îú‚îÄ‚îÄ Loading spinners
        Note right of TOOLBAR: ‚îî‚îÄ‚îÄ Smooth transitions

        alt –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ toolbar
            BROWSER->>TOOLBAR: DOM load complete
            TOOLBAR->>TOOLBAR: ToolbarContainer render
            TOOLBAR->>TOOLBAR: –ß—Ç–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏–∑ localStorage
            TOOLBAR->>WS_CLIENT: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è WebSocket
            TOOLBAR-->>BROWSER: Toolbar UI visible
        end
        
        alt –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ
            USER->>TOOLBAR: –ö–ª–∏–∫ –Ω–∞ Save All Changes
            TOOLBAR->>TOOLBAR: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI —Å–æ—Å—Ç–æ—è–Ω–∏—è
            TOOLBAR->>WS_CLIENT: emit('save_all_changes')
            TOOLBAR->>TOOLBAR: –ü–æ–∫–∞–∑ loading spinner
        end
    end

    %% === UPDATE MANAGER ===
    rect rgb(250, 255, 245)
        Note over UPDATER: üîÑ UPDATE MANAGER
        
        Note left of UPDATER: –ü–†–û–í–ï–†–ö–ê –û–ë–ù–û–í–õ–ï–ù–ò–ô
        Note left of UPDATER: ‚îú‚îÄ‚îÄ –ê–≤—Ç–æ–ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç
        Note left of UPDATER: ‚îú‚îÄ‚îÄ Manual check (Ctrl+Shift+U)
        Note left of UPDATER: ‚îú‚îÄ‚îÄ WebSocket push notifications
        Note left of UPDATER: ‚îú‚îÄ‚îÄ Version comparison (semver)
        Note left of UPDATER: ‚îî‚îÄ‚îÄ Channel management (stable/beta/dev)

        Note right of UPDATER: –ü–†–û–¶–ï–°–° –û–ë–ù–û–í–õ–ï–ù–ò–Ø
        Note right of UPDATER: ‚îú‚îÄ‚îÄ Download –Ω–æ–≤–æ–π –≤–µ—Ä—Å–∏–∏
        Note right of UPDATER: ‚îú‚îÄ‚îÄ Checksum validation
        Note right of UPDATER: ‚îú‚îÄ‚îÄ Backup —Ç–µ–∫—É—â–µ–π –≤–µ—Ä—Å–∏–∏
        Note right of UPDATER: ‚îú‚îÄ‚îÄ Hot Module Replacement
        Note right of UPDATER: ‚îú‚îÄ‚îÄ State preservation
        Note right of UPDATER: ‚îî‚îÄ‚îÄ Rollback –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö

        alt –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
            UPDATER->>UPDATER: setInterval(5 –º–∏–Ω—É—Ç)
            UPDATER->>R2: GET /api/toolbar/check
            R2-->>UPDATER: {hasUpdate: true, version: "0.2.1"}
            UPDATER->>UPDATER: –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –≤–µ—Ä—Å–∏–π
            UPDATER->>TOOLBAR: –ü–æ–∫–∞–∑ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–± –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏
        end
        
        alt –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
            UPDATER->>R2: Download –Ω–æ–≤–æ–π –≤–µ—Ä—Å–∏–∏ toolbar
            R2-->>UPDATER: ZIP —Ñ–∞–π–ª —Å –Ω–æ–≤—ã–º –∫–æ–¥–æ–º
            UPDATER->>UPDATER: Checksum validation
            UPDATER->>UPDATER: Backup current version
            UPDATER->>VITE_PLUGIN: Hot Module Replacement
            UPDATER->>TOOLBAR: UI —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ —É—Å–ø–µ—Ö–µ
        end
        
        alt WebSocket push –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
            WS_SERVER->>WS_CLIENT: emit('toolbar_update_available')
            WS_CLIENT->>UPDATER: –ù–µ–º–µ–¥–ª–µ–Ω–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
            UPDATER->>R2: –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
            UPDATER->>TOOLBAR: –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
        end
    end

    %% === WEBSOCKET –ò–ù–¢–ï–ì–†–ê–¶–ò–Ø ===
    rect rgb(255, 245, 250)
        Note over WS_CLIENT: üîÑ WEBSOCKET CLIENT –ò–ù–¢–ï–ì–†–ê–¶–ò–Ø
        
        Note left of WS_CLIENT: –ü–û–î–ö–õ–Æ–ß–ï–ù–ò–ï –ò –°–û–ë–´–¢–ò–Ø
        Note left of WS_CLIENT: ‚îú‚îÄ‚îÄ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        Note left of WS_CLIENT: ‚îú‚îÄ‚îÄ –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —Å PROJECT_ID
        Note left of WS_CLIENT: ‚îú‚îÄ‚îÄ Heartbeat/keepalive
        Note left of WS_CLIENT: ‚îú‚îÄ‚îÄ Reconnection logic
        Note left of WS_CLIENT: ‚îî‚îÄ‚îÄ Error handling

        Note right of WS_CLIENT: TOOLBAR SPECIFIC –°–û–ë–´–¢–ò–Ø
        Note right of WS_CLIENT: –û–¢–ü–†–ê–í–õ–Ø–ï–ú–´–ï:
        Note right of WS_CLIENT: ‚îú‚îÄ‚îÄ toolbar_connected
        Note right of WS_CLIENT: ‚îú‚îÄ‚îÄ save_all_changes
        Note right of WS_CLIENT: ‚îú‚îÄ‚îÄ discard_all_changes
        Note right of WS_CLIENT: ‚îî‚îÄ‚îÄ toolbar_status_update
        Note right of WS_CLIENT: –ü–û–õ–£–ß–ê–ï–ú–´–ï:
        Note right of WS_CLIENT: ‚îú‚îÄ‚îÄ toolbar_update_available
        Note right of WS_CLIENT: ‚îú‚îÄ‚îÄ pending_changes_updated
        Note right of WS_CLIENT: ‚îú‚îÄ‚îÄ deploy_status_update
        Note right of WS_CLIENT: ‚îî‚îÄ‚îÄ commit_created

        alt –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ toolbar –∫ —Å–µ—Ä–≤–µ—Ä—É
            TOOLBAR->>WS_CLIENT: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
            WS_CLIENT->>WS_SERVER: WebSocket connection
            WS_CLIENT->>WS_SERVER: emit('toolbar_connected', {projectId})
            WS_SERVER-->>WS_CLIENT: emit('authenticated')
            WS_CLIENT->>TOOLBAR: Connection established
        end
        
        alt Real-time —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è
            WS_SERVER->>WS_CLIENT: emit('pending_changes_updated', {count: 3})
            WS_CLIENT->>TOOLBAR: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ counter –≤ UI
            TOOLBAR->>TOOLBAR: –ê–Ω–∏–º–∞—Ü–∏—è counter –∏–∑–º–µ–Ω–µ–Ω–∏—è
        end
    end

    %% === R2 STORAGE –ò–ù–¢–ï–ì–†–ê–¶–ò–Ø ===
    rect rgb(250, 245, 255)
        Note over R2: ‚òÅÔ∏è R2 STORAGE –î–õ–Ø TOOLBAR –í–ï–†–°–ò–ô
        
        Note left of R2: –°–¢–†–£–ö–¢–£–†–ê –•–†–ê–ù–ò–õ–ò–©–ê
        Note left of R2: ‚îú‚îÄ‚îÄ toolbar-versions/
        Note left of R2: ‚îÇ   ‚îú‚îÄ‚îÄ 0.1.0/
        Note left of R2: ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ stable/toolbar.zip
        Note left of R2: ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ beta/toolbar.zip
        Note left of R2: ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ dev/toolbar.zip
        Note left of R2: ‚îÇ   ‚îú‚îÄ‚îÄ 0.2.0/
        Note left of R2: ‚îÇ   ‚îî‚îÄ‚îÄ latest/
        Note left of R2: ‚îÇ       ‚îî‚îÄ‚îÄ metadata.json
        Note left of R2: ‚îî‚îÄ‚îÄ checksums/
        Note left of R2:     ‚îî‚îÄ‚îÄ {version}-{channel}.sha256

        Note right of R2: –û–ü–ï–†–ê–¶–ò–ò –° –í–ï–†–°–ò–Ø–ú–ò
        Note right of R2: ‚îú‚îÄ‚îÄ Upload –Ω–æ–≤—ã—Ö –≤–µ—Ä—Å–∏–π
        Note right of R2: ‚îú‚îÄ‚îÄ Download –ø–æ –≤–µ—Ä—Å–∏–∏/–∫–∞–Ω–∞–ª—É
        Note right of R2: ‚îú‚îÄ‚îÄ Metadata management
        Note right of R2: ‚îú‚îÄ‚îÄ Checksum validation
        Note right of R2: ‚îî‚îÄ‚îÄ Cleanup —Å—Ç–∞—Ä—ã—Ö –≤–µ—Ä—Å–∏–π

        Note over R2: METADATA –°–¢–†–£–ö–¢–£–†–ê
        Note over R2: {
        Note over R2:   "latestVersion": "0.2.1",
        Note over R2:   "channels": {
        Note over R2:     "stable": "0.2.0",
        Note over R2:     "beta": "0.2.1",
        Note over R2:     "dev": "0.3.0-alpha"
        Note over R2:   },
        Note over R2:   "forceUpdate": false,
        Note over R2:   "releaseNotes": "Bug fixes..."
        Note over R2: }

        alt –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
            UPDATER->>R2: GET /toolbar-versions/latest/metadata.json
            R2-->>UPDATER: Metadata —Å –≤–µ—Ä—Å–∏—è–º–∏ –∫–∞–Ω–∞–ª–æ–≤
            UPDATER->>UPDATER: –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å —Ç–µ–∫—É—â–µ–π –≤–µ—Ä—Å–∏–µ–π
            UPDATER->>UPDATER: –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
        end
        
        alt –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –Ω–æ–≤–æ–π –≤–µ—Ä—Å–∏–∏
            UPDATER->>R2: GET /toolbar-versions/0.2.1/stable/toolbar.zip
            R2-->>UPDATER: ZIP –∞—Ä—Ö–∏–≤ —Å –Ω–æ–≤—ã–º –∫–æ–¥–æ–º
            UPDATER->>R2: GET /checksums/0.2.1-stable.sha256
            R2-->>UPDATER: Checksum –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏
            UPDATER->>UPDATER: –í–∞–ª–∏–¥–∞—Ü–∏—è —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏
        end
    end

    %% === ADMIN INTERFACE ===
    rect rgb(255, 255, 240)
        Note over ADMIN: üë®‚Äçüíº ADMIN INTERFACE
        
        Note left of ADMIN: WEB ADMIN –ü–ê–ù–ï–õ–¨
        Note left of ADMIN: ‚îú‚îÄ‚îÄ /admin/toolbar —Å—Ç—Ä–∞–Ω–∏—Ü–∞
        Note left of ADMIN: ‚îú‚îÄ‚îÄ Upload –Ω–æ–≤—ã—Ö –≤–µ—Ä—Å–∏–π
        Note left of ADMIN: ‚îú‚îÄ‚îÄ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞–Ω–∞–ª–∞–º–∏
        Note left of ADMIN: ‚îú‚îÄ‚îÄ Push notifications
        Note left of ADMIN: ‚îú‚îÄ‚îÄ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
        Note left of ADMIN: ‚îî‚îÄ‚îÄ Rollback –º–µ—Ö–∞–Ω–∏–∑–º

        Note right of ADMIN: –§–£–ù–ö–¶–ò–ò –£–ü–†–ê–í–õ–ï–ù–ò–Ø
        Note right of ADMIN: ‚îú‚îÄ‚îÄ Drag & Drop file upload
        Note right of ADMIN: ‚îú‚îÄ‚îÄ Version numbering (semver)
        Note right of ADMIN: ‚îú‚îÄ‚îÄ Release notes editor
        Note right of ADMIN: ‚îú‚îÄ‚îÄ Channel assignment
        Note right of ADMIN: ‚îú‚îÄ‚îÄ Force update flags
        Note right of ADMIN: ‚îî‚îÄ‚îÄ Broadcast to active users

        alt –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–æ–≤–æ–π –≤–µ—Ä—Å–∏–∏
            USER->>ADMIN: Drag & drop ZIP —Ñ–∞–π–ª–∞
            ADMIN->>ADMIN: –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–∞–π–ª–∞
            ADMIN->>R2: Upload –≤ R2 storage
            ADMIN->>ADMIN: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è checksum
            ADMIN->>R2: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ metadata.json
        end
        
        alt –†–∞—Å—Å—ã–ª–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
            USER->>ADMIN: –ö–ª–∏–∫ "Broadcast Update"
            ADMIN->>WS_SERVER: POST /api/toolbar/broadcast
            WS_SERVER->>WS_CLIENT: emit('toolbar_update_available')
            WS_CLIENT->>UPDATER: –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
            UPDATER->>TOOLBAR: –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
        end
    end

    %% === HOT MODULE REPLACEMENT ===
    rect rgb(245, 255, 245)
        Note over TOOLBAR: üî• HOT MODULE REPLACEMENT
        
        Note left of TOOLBAR: HMR –ú–ï–•–ê–ù–ò–ó–ú
        Note left of TOOLBAR: ‚îú‚îÄ‚îÄ Vite HMR API integration
        Note left of TOOLBAR: ‚îú‚îÄ‚îÄ Module replacement –±–µ–∑ reload
        Note left of TOOLBAR: ‚îú‚îÄ‚îÄ State preservation
        Note left of TOOLBAR: ‚îú‚îÄ‚îÄ Component tree update
        Note left of TOOLBAR: ‚îî‚îÄ‚îÄ CSS hot reload

        Note right of TOOLBAR: –ü–†–û–¶–ï–°–° –û–ë–ù–û–í–õ–ï–ù–ò–Ø
        Note right of TOOLBAR: ‚îú‚îÄ‚îÄ –ü–æ–ª—É—á–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –º–æ–¥—É–ª–µ–π
        Note right of TOOLBAR: ‚îú‚îÄ‚îÄ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
        Note right of TOOLBAR: ‚îú‚îÄ‚îÄ –ó–∞–º–µ–Ω–∞ –º–æ–¥—É–ª–µ–π –≤ runtime
        Note right of TOOLBAR: ‚îú‚îÄ‚îÄ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è
        Note right of TOOLBAR: ‚îî‚îÄ‚îÄ Re-render –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

        alt HMR –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
            UPDATER->>VITE_PLUGIN: –ù–æ–≤—ã–µ –º–æ–¥—É–ª–∏ –≥–æ—Ç–æ–≤—ã
            VITE_PLUGIN->>TOOLBAR: HMR update event
            TOOLBAR->>TOOLBAR: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è
            TOOLBAR->>TOOLBAR: –ó–∞–º–µ–Ω–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
            TOOLBAR->>TOOLBAR: –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è
            TOOLBAR-->>USER: Seamless update –±–µ–∑ reload
        end
    end

    %% === –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø –ò –ù–ê–°–¢–†–û–ô–ö–ò ===
    rect rgb(255, 250, 240)
        Note over TOOLBAR: ‚öôÔ∏è –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø –ò –ù–ê–°–¢–†–û–ô–ö–ò
        
        Note left of TOOLBAR: –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–¨–°–ö–ò–ï –ù–ê–°–¢–†–û–ô–ö–ò
        Note left of TOOLBAR: ‚îú‚îÄ‚îÄ –ü–æ–∑–∏—Ü–∏—è toolbar (corners)
        Note left of TOOLBAR: ‚îú‚îÄ‚îÄ –¢–µ–º–∞ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è (light/dark)
        Note left of TOOLBAR: ‚îú‚îÄ‚îÄ –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è (on/off)
        Note left of TOOLBAR: ‚îú‚îÄ‚îÄ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (types)
        Note left of TOOLBAR: ‚îú‚îÄ‚îÄ –ì–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏
        Note left of TOOLBAR: ‚îî‚îÄ‚îÄ Channel preference

        Note right of TOOLBAR: –ü–†–û–ï–ö–¢–ù–´–ï –ù–ê–°–¢–†–û–ô–ö–ò
        Note right of TOOLBAR: ‚îú‚îÄ‚îÄ vybcel.config.json
        Note right of TOOLBAR: ‚îÇ   ‚îú‚îÄ‚îÄ projectId
        Note right of TOOLBAR: ‚îÇ   ‚îú‚îÄ‚îÄ serverUrl
        Note right of TOOLBAR: ‚îÇ   ‚îú‚îÄ‚îÄ updateChannel
        Note right of TOOLBAR: ‚îÇ   ‚îî‚îÄ‚îÄ toolbarOptions
        Note right of TOOLBAR: ‚îú‚îÄ‚îÄ LocalStorage preferences
        Note right of TOOLBAR: ‚îî‚îÄ‚îÄ Environment variables

        alt –ò–∑–º–µ–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫
            USER->>TOOLBAR: –û—Ç–∫—Ä—ã—Ç–∏–µ settings menu
            TOOLBAR->>TOOLBAR: –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫
            USER->>TOOLBAR: –ò–∑–º–µ–Ω–µ–Ω–∏–µ position/theme
            TOOLBAR->>TOOLBAR: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ localStorage
            TOOLBAR->>TOOLBAR: –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π
        end
    end

    %% === –ü–†–û–ò–ó–í–û–î–ò–¢–ï–õ–¨–ù–û–°–¢–¨ –ò –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø ===
    rect rgb(250, 250, 255)
        Note over TOOLBAR: ‚ö° –ü–†–û–ò–ó–í–û–î–ò–¢–ï–õ–¨–ù–û–°–¢–¨ –ò –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø
        
        Note left of TOOLBAR: –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–ò
        Note left of TOOLBAR: ‚îú‚îÄ‚îÄ Lazy loading –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
        Note left of TOOLBAR: ‚îú‚îÄ‚îÄ Debounced user interactions
        Note left of TOOLBAR: ‚îú‚îÄ‚îÄ Minimal re-renders
        Note left of TOOLBAR: ‚îú‚îÄ‚îÄ Efficient state management
        Note left of TOOLBAR: ‚îú‚îÄ‚îÄ CSS containment
        Note left of TOOLBAR: ‚îî‚îÄ‚îÄ Bundle size optimization

        Note right of TOOLBAR: –ú–û–ù–ò–¢–û–†–ò–ù–ì
        Note right of TOOLBAR: ‚îú‚îÄ‚îÄ Performance metrics
        Note right of TOOLBAR: ‚îú‚îÄ‚îÄ Update success rate
        Note right of TOOLBAR: ‚îú‚îÄ‚îÄ Error tracking
        Note right of TOOLBAR: ‚îú‚îÄ‚îÄ User engagement
        Note right of TOOLBAR: ‚îî‚îÄ‚îÄ Network efficiency

        alt Performance monitoring
            TOOLBAR->>TOOLBAR: performance.mark('start')
            TOOLBAR->>UPDATER: Check for updates
            TOOLBAR->>TOOLBAR: performance.mark('end')
            TOOLBAR->>TOOLBAR: performance.measure('update-check')
        end
    end

    %% === –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨ ===
    rect rgb(255, 245, 245)
        Note over TOOLBAR: üîí –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨ –ò –í–ê–õ–ò–î–ê–¶–ò–Ø
        
        Note left of TOOLBAR: –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨ –û–ë–ù–û–í–õ–ï–ù–ò–ô
        Note left of TOOLBAR: ‚îú‚îÄ‚îÄ Checksum validation (SHA-256)
        Note left of TOOLBAR: ‚îú‚îÄ‚îÄ Source verification
        Note left of TOOLBAR: ‚îú‚îÄ‚îÄ HTTPS only downloads
        Note left of TOOLBAR: ‚îú‚îÄ‚îÄ Sandboxed execution
        Note left of TOOLBAR: ‚îî‚îÄ‚îÄ Rollback –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö

        Note right of TOOLBAR: –ó–ê–©–ò–¢–ê –û–¢ –ê–¢–ê–ö
        Note right of TOOLBAR: ‚îú‚îÄ‚îÄ CSP (Content Security Policy)
        Note right of TOOLBAR: ‚îú‚îÄ‚îÄ XSS protection
        Note right of TOOLBAR: ‚îú‚îÄ‚îÄ Code injection prevention
        Note right of TOOLBAR: ‚îú‚îÄ‚îÄ Secure WebSocket (WSS)
        Note right of TOOLBAR: ‚îî‚îÄ‚îÄ Rate limiting

        alt –í–∞–ª–∏–¥–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
            UPDATER->>R2: Download update + checksum
            UPDATER->>UPDATER: SHA-256 verification
            alt Valid checksum
                UPDATER->>TOOLBAR: –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
            else Invalid checksum
                UPDATER->>TOOLBAR: –û—à–∏–±–∫–∞ + rollback
                UPDATER->>ADMIN: Report security issue
            end
        end
    end