sequenceDiagram
    participant WS as ðŸ”„ WebSocket Server
    participant GITHUB_APP as ðŸ¤– GitHub App
    participant GITHUB_API as ðŸ™ GitHub API
    participant REPO as ðŸ“¦ GitHub Repository
    participant NETLIFY_API as ðŸš€ Netlify API
    participant NETLIFY_SITE as ðŸŒ Netlify Site
    participant BUILD as ðŸ—ï¸ Build Process
    participant CDN as ðŸŒ CDN/Edge

    Note over WS,CDN: ðŸ”— EXTERNAL SERVICES - Ð”Ð•Ð¢ÐÐ›Ð¬ÐÐÐ¯ ÐÐ Ð¥Ð˜Ð¢Ð•ÐšÐ¢Ð£Ð Ð

    %% === GITHUB APP Ð˜ÐÐ¢Ð•Ð“Ð ÐÐ¦Ð˜Ð¯ ===
    rect rgb(250, 245, 255)
        Note over GITHUB_APP: ðŸ¤– GITHUB APP ÐÐ Ð¥Ð˜Ð¢Ð•ÐšÐ¢Ð£Ð Ð
        
        Note left of GITHUB_APP: ÐšÐžÐÐ¤Ð˜Ð“Ð£Ð ÐÐ¦Ð˜Ð¯ GITHUB APP
        Note left of GITHUB_APP: â”œâ”€â”€ App Name: "Vybcel Bot"
        Note left of GITHUB_APP: â”œâ”€â”€ App ID: 1390062
        Note left of GITHUB_APP: â”œâ”€â”€ Installation ID: 70719351
        Note left of GITHUB_APP: â”œâ”€â”€ Organization: vybcel
        Note left of GITHUB_APP: â”œâ”€â”€ Private Key (PEM format)
        Note left of GITHUB_APP: â””â”€â”€ Webhook URL (Ð´Ð»Ñ ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ð¹)

        Note right of GITHUB_APP: PERMISSIONS Ð˜ SCOPE
        Note right of GITHUB_APP: â”œâ”€â”€ Repository permissions:
        Note right of GITHUB_APP: â”‚   â”œâ”€â”€ Contents: Read & Write
        Note right of GITHUB_APP: â”‚   â”œâ”€â”€ Metadata: Read
        Note right of GITHUB_APP: â”‚   â”œâ”€â”€ Pull requests: Read & Write
        Note right of GITHUB_APP: â”‚   â””â”€â”€ Administration: Write
        Note right of GITHUB_APP: â”œâ”€â”€ Organization permissions:
        Note right of GITHUB_APP: â”‚   â”œâ”€â”€ Members: Read
        Note right of GITHUB_APP: â”‚   â””â”€â”€ Administration: Write
        Note right of GITHUB_APP: â””â”€â”€ Account permissions:
        Note right of GITHUB_APP:     â””â”€â”€ Email addresses: Read

        Note over GITHUB_APP: JWT AUTHENTICATION FLOW
        Note over GITHUB_APP: â”œâ”€â”€ Ð“ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ñ JWT Ñ private key
        Note over GITHUB_APP: â”œâ”€â”€ ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ðµ installation token (60 Ð¼Ð¸Ð½)
        Note over GITHUB_APP: â”œâ”€â”€ Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ token Ð´Ð»Ñ API calls
        Note over GITHUB_APP: â””â”€â”€ ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¾Ðµ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ Ñ‚Ð¾ÐºÐµÐ½Ð¾Ð²

        alt JWT Token Generation
            WS->>GITHUB_APP: Ð“ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ñ installation token
            GITHUB_APP->>GITHUB_APP: Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ JWT Ñ private key
            GITHUB_APP->>GITHUB_API: POST /app/installations/{id}/access_tokens
            GITHUB_API-->>GITHUB_APP: Installation token (60 Ð¼Ð¸Ð½)
            GITHUB_APP-->>WS: Ready Ð´Ð»Ñ API Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸Ð¹
        end
        
        alt Token Refresh
            GITHUB_APP->>GITHUB_APP: Token expiration check
            GITHUB_APP->>GITHUB_API: ÐÐ¾Ð²Ñ‹Ð¹ installation token
            GITHUB_API-->>GITHUB_APP: ÐžÐ±Ð½Ð¾Ð²Ð»ÐµÐ½Ð½Ñ‹Ð¹ token
            GITHUB_APP->>WS: Token refreshed
        end
    end

    %% === GITHUB REPOSITORY OPERATIONS ===
    rect rgb(240, 248, 255)
        Note over REPO: ðŸ“¦ GITHUB REPOSITORY ÐžÐŸÐ•Ð ÐÐ¦Ð˜Ð˜
        
        Note left of REPO: Ð¡ÐžÐ—Ð”ÐÐÐ˜Ð• Ð Ð•ÐŸÐžÐ—Ð˜Ð¢ÐžÐ Ð˜Ð¯
        Note left of REPO: â”œâ”€â”€ POST /orgs/vybcel/repos
        Note left of REPO: â”œâ”€â”€ Private repository by default
        Note left of REPO: â”œâ”€â”€ Auto-initialization Ñ README
        Note left of REPO: â”œâ”€â”€ Default branch: main
        Note left of REPO: â”œâ”€â”€ Repository naming: vybcel-project-{id}
        Note left of REPO: â””â”€â”€ Template files injection

        Note right of REPO: FILE OPERATIONS
        Note right of REPO: â”œâ”€â”€ PUT /repos/{owner}/{repo}/contents/{path}
        Note right of REPO: â”‚   â””â”€â”€ Create/Update Ñ„Ð°Ð¹Ð»Ð¾Ð²
        Note right of REPO: â”œâ”€â”€ GET /repos/{owner}/{repo}/contents/{path}
        Note right of REPO: â”‚   â””â”€â”€ Read file contents
        Note right of REPO: â”œâ”€â”€ DELETE /repos/{owner}/{repo}/contents/{path}
        Note right of REPO: â”‚   â””â”€â”€ Delete Ñ„Ð°Ð¹Ð»Ð¾Ð²
        Note right of REPO: â””â”€â”€ Batch operations Ð´Ð»Ñ multiple files

        Note over REPO: GIT OPERATIONS
        Note over REPO: â”œâ”€â”€ Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ blobs Ð´Ð»Ñ Ñ„Ð°Ð¹Ð»Ð¾Ð²
        Note over REPO: â”œâ”€â”€ Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ tree Ñ Ñ„Ð°Ð¹Ð»Ð¾Ð²Ð¾Ð¹ ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð¾Ð¹
        Note over REPO: â”œâ”€â”€ Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ commit Ñ message
        Note over REPO: â””â”€â”€ ÐžÐ±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ main branch reference

        alt Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ñ€ÐµÐ¿Ð¾Ð·Ð¸Ñ‚Ð¾Ñ€Ð¸Ñ
            WS->>GITHUB_API: POST /orgs/vybcel/repos
            GITHUB_API->>REPO: Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ð¿Ñ€Ð¸Ð²Ð°Ñ‚Ð½Ð¾Ð³Ð¾ Ñ€ÐµÐ¿Ð¾
            REPO->>REPO: Ð˜Ð½Ð¸Ñ†Ð¸Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ Ñ README
            REPO->>REPO: ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° default branch (main)
            REPO-->>WS: Repository URL + clone URL
        end
        
        alt Batch upload Ñ„Ð°Ð¹Ð»Ð¾Ð²
            WS->>GITHUB_API: ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ðµ parent commit SHA
            GITHUB_API-->>WS: Latest commit SHA
            
            loop Ð”Ð»Ñ ÐºÐ°Ð¶Ð´Ð¾Ð³Ð¾ Ñ„Ð°Ð¹Ð»Ð°
                WS->>GITHUB_API: POST /repos/{owner}/{repo}/git/blobs
                GITHUB_API-->>WS: Blob SHA
            end
            
            WS->>GITHUB_API: POST /repos/{owner}/{repo}/git/trees
            GITHUB_API-->>WS: Tree SHA
            
            WS->>GITHUB_API: POST /repos/{owner}/{repo}/git/commits
            GITHUB_API-->>WS: Commit SHA
            
            WS->>GITHUB_API: PATCH /repos/{owner}/{repo}/git/refs/heads/main
            GITHUB_API-->>WS: Updated main branch
        end
        
        alt Ð£Ð´Ð°Ð»ÐµÐ½Ð¸Ðµ Ñ€ÐµÐ¿Ð¾Ð·Ð¸Ñ‚Ð¾Ñ€Ð¸Ñ
            WS->>GITHUB_API: DELETE /repos/vybcel/{repo-name}
            GITHUB_API->>REPO: Repository deletion
            REPO->>REPO: Ð£Ð´Ð°Ð»ÐµÐ½Ð¸Ðµ Ð²ÑÐµÑ… Ñ„Ð°Ð¹Ð»Ð¾Ð² Ð¸ Ð¸ÑÑ‚Ð¾Ñ€Ð¸Ð¸
            REPO-->>WS: Deletion confirmed
        end
    end

    %% === GITHUB WEBHOOKS ===
    rect rgb(255, 250, 240)
        Note over GITHUB_API: ðŸ”” GITHUB WEBHOOKS
        
        Note left of GITHUB_API: WEBHOOK EVENTS
        Note left of GITHUB_API: â”œâ”€â”€ push (commits Ð² main)
        Note left of GITHUB_API: â”œâ”€â”€ pull_request (PR ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ñ)
        Note left of GITHUB_API: â”œâ”€â”€ repository (ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ðµ/ÑƒÐ´Ð°Ð»ÐµÐ½Ð¸Ðµ)
        Note left of GITHUB_API: â”œâ”€â”€ installation (app install/uninstall)
        Note left of GITHUB_API: â””â”€â”€ release (Ð½Ð¾Ð²Ñ‹Ðµ Ñ€ÐµÐ»Ð¸Ð·Ñ‹)

        Note right of GITHUB_API: WEBHOOK PAYLOAD
        Note right of GITHUB_API: â”œâ”€â”€ Headers:
        Note right of GITHUB_API: â”‚   â”œâ”€â”€ X-GitHub-Event
        Note right of GITHUB_API: â”‚   â”œâ”€â”€ X-GitHub-Delivery
        Note right of GITHUB_API: â”‚   â””â”€â”€ X-Hub-Signature-256
        Note right of GITHUB_API: â”œâ”€â”€ Body:
        Note right of GITHUB_API: â”‚   â”œâ”€â”€ action (opened, closed, etc.)
        Note right of GITHUB_API: â”‚   â”œâ”€â”€ repository (repo info)
        Note right of GITHUB_API: â”‚   â”œâ”€â”€ sender (user info)
        Note right of GITHUB_API: â”‚   â””â”€â”€ commits (Ð´Ð»Ñ push events)

        alt Push webhook
            REPO->>GITHUB_API: Git push to main branch
            GITHUB_API->>WS: POST /webhooks/github
            WS->>WS: Signature verification
            WS->>WS: ÐŸÐ°Ñ€ÑÐ¸Ð½Ð³ payload
            WS->>WS: Trigger auto-deploy if needed
        end
        
        alt Repository webhook
            GITHUB_API->>WS: Repository created/deleted
            WS->>WS: Update internal state
            WS->>WS: Cleanup related resources
        end
    end

    %% === NETLIFY API Ð˜ÐÐ¢Ð•Ð“Ð ÐÐ¦Ð˜Ð¯ ===
    rect rgb(255, 245, 250)
        Note over NETLIFY_API: ðŸš€ NETLIFY API ÐÐ Ð¥Ð˜Ð¢Ð•ÐšÐ¢Ð£Ð Ð
        
        Note left of NETLIFY_API: API CONFIGURATION
        Note left of NETLIFY_API: â”œâ”€â”€ Access Token (Personal/Team)
        Note left of NETLIFY_API: â”œâ”€â”€ API Base URL: api.netlify.com
        Note left of NETLIFY_API: â”œâ”€â”€ Rate Limits: 500 requests/min
        Note left of NETLIFY_API: â”œâ”€â”€ Authentication: Bearer token
        Note left of NETLIFY_API: â””â”€â”€ HTTPS only

        Note right of NETLIFY_API: CORE API ENDPOINTS
        Note right of NETLIFY_API: â”œâ”€â”€ Sites Management:
        Note right of NETLIFY_API: â”‚   â”œâ”€â”€ POST /sites (ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ðµ)
        Note right of NETLIFY_API: â”‚   â”œâ”€â”€ GET /sites/{id} (Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ)
        Note right of NETLIFY_API: â”‚   â”œâ”€â”€ PATCH /sites/{id} (Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ)
        Note right of NETLIFY_API: â”‚   â””â”€â”€ DELETE /sites/{id} (ÑƒÐ´Ð°Ð»ÐµÐ½Ð¸Ðµ)
        Note right of NETLIFY_API: â”œâ”€â”€ Deploy Management:
        Note right of NETLIFY_API: â”‚   â”œâ”€â”€ POST /sites/{id}/deploys
        Note right of NETLIFY_API: â”‚   â”œâ”€â”€ GET /deploys/{id}
        Note right of NETLIFY_API: â”‚   â””â”€â”€ POST /deploys/{id}/restore
        Note right of NETLIFY_API: â”œâ”€â”€ Build Configuration:
        Note right of NETLIFY_API: â”‚   â”œâ”€â”€ Build command setting
        Note right of NETLIFY_API: â”‚   â”œâ”€â”€ Publish directory
        Note right of NETLIFY_API: â”‚   â””â”€â”€ Environment variables
        Note right of NETLIFY_API: â””â”€â”€ Webhooks:
        Note right of NETLIFY_API:     â”œâ”€â”€ POST /hooks
        Note right of NETLIFY_API:     â””â”€â”€ Webhook event types

        alt Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ Netlify ÑÐ°Ð¹Ñ‚Ð°
            WS->>NETLIFY_API: POST /sites
            NETLIFY_API->>NETLIFY_SITE: Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ð½Ð¾Ð²Ð¾Ð³Ð¾ ÑÐ°Ð¹Ñ‚Ð°
            NETLIFY_SITE->>NETLIFY_SITE: Ð“ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ñ subdomain
            NETLIFY_SITE->>NETLIFY_SITE: ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° GitHub integration
            NETLIFY_API-->>WS: Site ID + URL + deploy settings
        end
        
        alt ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° GitHub Ð¸Ð½Ñ‚ÐµÐ³Ñ€Ð°Ñ†Ð¸Ð¸
            WS->>NETLIFY_API: PATCH /sites/{id} Ñ GitHub repo URL
            NETLIFY_API->>NETLIFY_SITE: ÐšÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ñ GitHub ÑÐ²ÑÐ·Ð¸
            NETLIFY_SITE->>GITHUB_API: ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° deploy key
            NETLIFY_SITE->>GITHUB_API: Ð£ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° webhook
            NETLIFY_API-->>WS: Integration configured
        end
    end

    %% === NETLIFY BUILD PROCESS ===
    rect rgb(250, 255, 245)
        Note over BUILD: ðŸ—ï¸ NETLIFY BUILD PROCESS
        
        Note left of BUILD: BUILD CONFIGURATION
        Note left of BUILD: â”œâ”€â”€ Build Command: "pnpm install && pnpm build"
        Note left of BUILD: â”œâ”€â”€ Publish Directory: "dist/"
        Note left of BUILD: â”œâ”€â”€ Node.js Version: 18.x
        Note left of BUILD: â”œâ”€â”€ Package Manager: pnpm
        Note left of BUILD: â”œâ”€â”€ Build Timeout: 15 minutes
        Note left of BUILD: â””â”€â”€ Environment Variables

        Note right of BUILD: BUILD STEPS
        Note right of BUILD: â”œâ”€â”€ 1. Git clone Ð¾Ñ‚ GitHub
        Note right of BUILD: â”œâ”€â”€ 2. Dependencies installation
        Note right of BUILD: â”œâ”€â”€ 3. Build script execution
        Note right of BUILD: â”œâ”€â”€ 4. Output validation
        Note right of BUILD: â”œâ”€â”€ 5. Asset optimization
        Note right of BUILD: â”œâ”€â”€ 6. CDN deployment
        Note right of BUILD: â””â”€â”€ 7. Cache invalidation

        Note over BUILD: BUILD ENVIRONMENT
        Note over BUILD: â”œâ”€â”€ Ubuntu-based container
        Note over BUILD: â”œâ”€â”€ Isolated build environment
        Note over BUILD: â”œâ”€â”€ Build caching (node_modules)
        Note over BUILD: â”œâ”€â”€ Asset processing pipeline
        Note over BUILD: â””â”€â”€ Deploy preview generation

        alt Successful build
            NETLIFY_SITE->>BUILD: Trigger build from GitHub push
            BUILD->>GITHUB_API: Git clone repository
            BUILD->>BUILD: pnpm install (dependencies)
            BUILD->>BUILD: pnpm build (compilation)
            BUILD->>BUILD: Asset optimization
            BUILD->>CDN: Deploy to edge locations
            BUILD->>WS: Webhook: deploy-succeeded
        end
        
        alt Failed build
            BUILD->>BUILD: Build error detected
            BUILD->>BUILD: Capture error logs
            BUILD->>WS: Webhook: deploy-failed
            BUILD->>BUILD: Cleanup build artifacts
        end
    end

    %% === NETLIFY WEBHOOKS ===
    rect rgb(245, 255, 245)
        Note over NETLIFY_API: ðŸ”” NETLIFY WEBHOOKS
        
        Note left of NETLIFY_API: WEBHOOK EVENTS
        Note left of NETLIFY_API: â”œâ”€â”€ deploy-building
        Note left of NETLIFY_API: â”œâ”€â”€ deploy-succeeded
        Note left of NETLIFY_API: â”œâ”€â”€ deploy-failed
        Note left of NETLIFY_API: â”œâ”€â”€ deploy-locked
        Note left of NETLIFY_API: â”œâ”€â”€ deploy-unlocked
        Note left of NETLIFY_API: â””â”€â”€ site-created

        Note right of NETLIFY_API: WEBHOOK PAYLOAD
        Note right of NETLIFY_API: â”œâ”€â”€ id (deploy ID)
        Note right of NETLIFY_API: â”œâ”€â”€ site_id (site identifier)
        Note right of NETLIFY_API: â”œâ”€â”€ state (building/ready/error)
        Note right of NETLIFY_API: â”œâ”€â”€ url (deploy URL)
        Note right of NETLIFY_API: â”œâ”€â”€ ssl_url (HTTPS URL)
        Note right of NETLIFY_API: â”œâ”€â”€ created_at (timestamp)
        Note right of NETLIFY_API: â”œâ”€â”€ error_message (ÐµÑÐ»Ð¸ ÐµÑÑ‚ÑŒ)
        Note right of NETLIFY_API: â””â”€â”€ build_log_url (ÑÑÑ‹Ð»ÐºÐ° Ð½Ð° Ð»Ð¾Ð³Ð¸)

        alt Deploy webhook processing
            NETLIFY_SITE->>WS: POST /webhooks/netlify
            WS->>WS: Webhook signature verification
            WS->>WS: ÐŸÐ°Ñ€ÑÐ¸Ð½Ð³ deploy payload
            WS->>WS: ÐžÐ±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ project deploy_status
            WS->>WS: Broadcast to WebSocket clients
        end
    end

    %% === CDN Ð˜ EDGE DEPLOYMENT ===
    rect rgb(255, 255, 245)
        Note over CDN: ðŸŒ CDN Ð˜ EDGE DEPLOYMENT
        
        Note left of CDN: NETLIFY CDN FEATURES
        Note left of CDN: â”œâ”€â”€ Global edge locations
        Note left of CDN: â”œâ”€â”€ Automatic asset optimization
        Note left of CDN: â”œâ”€â”€ Image processing
        Note left of CDN: â”œâ”€â”€ Gzip/Brotli compression
        Note left of CDN: â”œâ”€â”€ Cache invalidation
        Note left of CDN: â”œâ”€â”€ Custom headers
        Note left of CDN: â””â”€â”€ Edge functions support

        Note right of CDN: PERFORMANCE OPTIMIZATION
        Note right of CDN: â”œâ”€â”€ Static asset caching
        Note right of CDN: â”œâ”€â”€ HTTP/2 support
        Note right of CDN: â”œâ”€â”€ Progressive Web App features
        Note right of CDN: â”œâ”€â”€ Asset bundling optimization
        Note right of CDN: â”œâ”€â”€ Critical CSS inlining
        Note right of CDN: â””â”€â”€ Lazy loading implementation

        alt Asset deployment
            BUILD->>CDN: Upload optimized assets
            CDN->>CDN: Distribute to edge locations
            CDN->>CDN: Setup cache headers
            CDN->>CDN: Generate deploy URL
            CDN-->>BUILD: Deployment ready
        end
    end

    %% === ERROR HANDLING Ð˜ MONITORING ===
    rect rgb(255, 245, 245)
        Note over WS: âŒ ERROR HANDLING Ð˜ MONITORING
        
        Note left of WS: GITHUB API ERROR HANDLING
        Note left of WS: â”œâ”€â”€ Rate limit handling (5000 req/hour)
        Note left of WS: â”œâ”€â”€ API timeout handling (30s)
        Note left of WS: â”œâ”€â”€ Network retry logic (exponential backoff)
        Note left of WS: â”œâ”€â”€ Token expiration handling
        Note left of WS: â”œâ”€â”€ Repository access errors
        Note left of WS: â””â”€â”€ Webhook delivery failures

        Note right of WS: NETLIFY API ERROR HANDLING
        Note right of WS: â”œâ”€â”€ Build failure notifications
        Note right of WS: â”œâ”€â”€ Deploy timeout handling (15 min)
        Note right of WS: â”œâ”€â”€ Site limit monitoring
        Note right of WS: â”œâ”€â”€ Bandwidth usage tracking
        Note right of WS: â”œâ”€â”€ SSL certificate issues
        Note right of WS: â””â”€â”€ Custom domain configuration

        alt GitHub API rate limit
            WS->>GITHUB_API: API request
            GITHUB_API-->>WS: 403 Rate limit exceeded
            WS->>WS: Exponential backoff delay
            WS->>WS: Queue request for retry
            WS->>GITHUB_API: Retry after delay
        end
        
        alt Netlify build failure
            BUILD->>WS: deploy-failed webhook
            WS->>WS: Parse error details
            WS->>WS: Log error Ð´Ð»Ñ debugging
            WS->>WS: Notify user Ñ‡ÐµÑ€ÐµÐ· UI
            WS->>WS: Optionally retry deploy
        end
    end

    %% === SECURITY Ð˜ BEST PRACTICES ===
    rect rgb(250, 250, 255)
        Note over WS: ðŸ”’ SECURITY Ð˜ BEST PRACTICES
        
        Note left of WS: GITHUB SECURITY
        Note left of WS: â”œâ”€â”€ Private key secure storage
        Note left of WS: â”œâ”€â”€ JWT token short lifetime (10 min)
        Note left of WS: â”œâ”€â”€ Installation token rotation
        Note left of WS: â”œâ”€â”€ Webhook signature verification
        Note left of WS: â”œâ”€â”€ Repository access auditing
        Note left of WS: â””â”€â”€ Least privilege Ð¿Ñ€Ð¸Ð½Ñ†Ð¸Ð¿

        Note right of WS: NETLIFY SECURITY
        Note right of WS: â”œâ”€â”€ Access token secure storage
        Note right of WS: â”œâ”€â”€ HTTPS enforcement
        Note right of WS: â”œâ”€â”€ Environment variable encryption
        Note right of WS: â”œâ”€â”€ Build log access control
        Note right of WS: â”œâ”€â”€ Deploy branch protection
        Note right of WS: â””â”€â”€ Custom domain SSL/TLS

        Note over WS: API COMMUNICATION SECURITY
        Note over WS: â”œâ”€â”€ HTTPS only Ð´Ð»Ñ Ð²ÑÐµÑ… API calls
        Note over WS: â”œâ”€â”€ Request/response validation
        Note over WS: â”œâ”€â”€ API key rotation policies
        Note over WS: â”œâ”€â”€ Audit logging Ð´Ð»Ñ API usage
        Note over WS: â””â”€â”€ Error message sanitization

        alt Secure API communication
            WS->>WS: Encrypt sensitive data
            WS->>GITHUB_API: HTTPS API request
            GITHUB_API-->>WS: Secure response
            WS->>WS: Validate response integrity
            WS->>WS: Log API usage (sanitized)
        end
    end

    %% === INTEGRATION PATTERNS ===
    rect rgb(245, 245, 255)
        Note over WS: ðŸ”„ INTEGRATION PATTERNS
        
        Note left of WS: REPOSITORY LIFECYCLE
        Note left of WS: â”œâ”€â”€ Create â†’ Initialize â†’ Upload template
        Note left of WS: â”œâ”€â”€ Update â†’ Commit changes â†’ Auto-deploy
        Note left of WS: â”œâ”€â”€ Backup â†’ Branch creation â†’ Archive
        Note left of WS: â””â”€â”€ Delete â†’ Cleanup â†’ Resource deallocation

        Note right of WS: DEPLOYMENT LIFECYCLE
        Note right of WS: â”œâ”€â”€ Site creation â†’ GitHub integration setup
        Note right of WS: â”œâ”€â”€ Build trigger â†’ Progress monitoring
        Note right of WS: â”œâ”€â”€ Deploy success â†’ URL generation
        Note right of WS: â””â”€â”€ Cleanup â†’ Site/domain deallocation

        Note over WS: ERROR RECOVERY PATTERNS
        Note over WS: â”œâ”€â”€ Retry mechanisms Ñ exponential backoff
        Note over WS: â”œâ”€â”€ Fallback strategies Ð´Ð»Ñ service outages
        Note over WS: â”œâ”€â”€ Circuit breaker pattern Ð´Ð»Ñ API calls
        Note over WS: â”œâ”€â”€ Graceful degradation Ð¿Ñ€Ð¸ partial failures
        Note over WS: â””â”€â”€ User notification Ð¿Ñ€Ð¸ critical errors

        alt End-to-end project creation
            WS->>GITHUB_API: Create repository
            GITHUB_API-->>WS: Repository ready
            WS->>GITHUB_API: Upload template files
            GITHUB_API-->>WS: Files committed
            WS->>NETLIFY_API: Create site with GitHub link
            NETLIFY_API-->>WS: Site ready + auto-deploy configured
            WS->>WS: Project fully initialized
        end
    end